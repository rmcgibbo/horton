

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>6. horton – The main Horton Package &mdash; Horton 1.2.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/breathe.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Horton 1.2.1 documentation" href="../index.html" />
    <link rel="next" title="7. horton.espfit – Electrostatic potential fitting" href="horton_espfit.html" />
    <link rel="prev" title="5. Literature" href="../ref_literature.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="horton_espfit.html" title="7. horton.espfit – Electrostatic potential fitting"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../ref_literature.html" title="5. Literature"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Horton 1.2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="horton-the-main-horton-package">
<h1>6. <tt class="docutils literal"><span class="pre">horton</span></tt> &#8211; The main Horton Package<a class="headerlink" href="#horton-the-main-horton-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-horton.cache">
<span id="horton-cache-avoid-recomputation-of-earlier-results-and-reallocation-of-existing-arrays"></span><h2>6.1. <tt class="docutils literal"><span class="pre">horton.cache</span></tt> &#8211; Avoid recomputation of earlier results and reallocation of existing arrays<a class="headerlink" href="#module-horton.cache" title="Permalink to this headline">¶</a></h2>
<p>In principle, the <tt class="docutils literal"><span class="pre">JustOnceClass</span></tt> and the <tt class="docutils literal"><span class="pre">Cache</span></tt> can be used
independently, but in some cases it makes a lot of sense to combine them.
See for example the density partitioning code in <tt class="docutils literal"><span class="pre">horton.part</span></tt>.</p>
<dl class="class">
<dt id="horton.cache.JustOnceClass">
<em class="property">class </em><tt class="descclassname">horton.cache.</tt><tt class="descname">JustOnceClass</tt><a class="headerlink" href="#horton.cache.JustOnceClass" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for classes with methods that should never be executed twice.</p>
<p>In typically applications, these methods get called many times, but
only during the first call, an actual computation is carried out. This
way, the caller can safely call a method, just to make sure that a
required result is computed.</p>
<p>All methods in the subclasses that should have this feature, must be
given the <tt class="docutils literal"><span class="pre">just_once</span></tt> decoratore, e.g.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Example</span><span class="p">(</span><span class="n">JustOnceClass</span><span class="p">):</span>
    <span class="nd">@just_once</span>
    <span class="k">def</span> <span class="nf">do_something</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">foo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bar</span>
</pre></div>
</div>
<p>When all results are outdated, one can call the <tt class="docutils literal"><span class="pre">clear</span></tt> method
to forget which methods were called already.</p>
<dl class="method">
<dt id="horton.cache.JustOnceClass.clear">
<tt class="descname">clear</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.cache.JustOnceClass.clear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="horton.cache.just_once">
<tt class="descclassname">horton.cache.</tt><tt class="descname">just_once</tt><big>(</big><em>fn</em><big>)</big><a class="headerlink" href="#horton.cache.just_once" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="class">
<dt id="horton.cache.Cache">
<em class="property">class </em><tt class="descclassname">horton.cache.</tt><tt class="descname">Cache</tt><a class="headerlink" href="#horton.cache.Cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Object that stores previously computed results.</p>
<p>The cache behaves like a dictionary with some extra features that can be
used to avoid recomputation or reallocation.</p>
<dl class="method">
<dt id="horton.cache.Cache.__getitem__">
<tt class="descname">__getitem__</tt><big>(</big><em>key</em><big>)</big><a class="headerlink" href="#horton.cache.Cache.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.cache.Cache.clear">
<tt class="descname">clear</tt><big>(</big><em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.cache.Cache.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear all items in the cache</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>dealloc</dt>
<dd>When set to True, the items are really removed from memory.</dd>
<dt>tags</dt>
<dd>Limit the items cleared to those who have at least one tag
that matches one of the given tags. When this argument is used
and it contains at least one tag, items with no tags are not
cleared.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.cache.Cache.clear_item">
<tt class="descname">clear_item</tt><big>(</big><em>*key</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.cache.Cache.clear_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear a selected item from the cache</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>dealloc</dt>
<dd>When set to True, the item is really removed from memory.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.cache.Cache.dump">
<tt class="descname">dump</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.cache.Cache.dump" title="Permalink to this definition">¶</a></dt>
<dd><p>Store an object in the cache.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>key1 [, key2, ...]</dt>
<dd>The positional arguments (except for the last) are used as a key
for the object.</dd>
<dt>value</dt>
<dd>The object to be stored.</dd>
</dl>
<p><strong>Optional argument:</strong></p>
<dl class="docutils">
<dt>own</dt>
<dd>When set to True, the cache will take care of denouncing the
memory usage due to this array.</dd>
<dt>tags</dt>
<dd>Tags to be associated with the object</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.cache.Cache.iteritems">
<tt class="descname">iteritems</tt><big>(</big><em>tags=None</em><big>)</big><a class="headerlink" href="#horton.cache.Cache.iteritems" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over all valid items in the cache.</p>
</dd></dl>

<dl class="method">
<dt id="horton.cache.Cache.iterkeys">
<tt class="descname">iterkeys</tt><big>(</big><em>tags=None</em><big>)</big><a class="headerlink" href="#horton.cache.Cache.iterkeys" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the keys of all valid items in the cache.</p>
</dd></dl>

<dl class="method">
<dt id="horton.cache.Cache.itervalues">
<tt class="descname">itervalues</tt><big>(</big><em>tags=None</em><big>)</big><a class="headerlink" href="#horton.cache.Cache.itervalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the values of all valid items in the cache.</p>
</dd></dl>

<dl class="method">
<dt id="horton.cache.Cache.load">
<tt class="descname">load</tt><big>(</big><em>*key</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.cache.Cache.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a value from the cache</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>key0 [key1 ...]</dt>
<dd>All positional arguments are used as keys to identify the cached
value.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>alloc</dt>
<dd>Parameters used to allocate a cached value if it is not present
yet. This argument can take two forms. When integer or a
tuple of integers is given, an array is allocated.
Alternatively, a tuple may be given whose first element is a
constructor, and further elements are arguments for that
constructor.</dd>
<dt>default</dt>
<dd>A default value that is returned when the key does not exist in
the cache. This default value is not stored in the cache.</dd>
<dt>tags</dt>
<dd>When alloc is used and a new object is thereby created or
reused, it will get these tags. This argument is only allowed if
the alloc argument is present. In case no new object is
allocated, the given tags must match those already present.</dd>
</dl>
<p>The optional argument alloc and default are both meant to handle
situations when the key has not associated value. Hence they can not
be both present.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-horton.cext">
<span id="horton-cext-c-extensions"></span><h2>6.2. <tt class="docutils literal"><span class="pre">horton.cext</span></tt> &#8211; C++ extensions<a class="headerlink" href="#module-horton.cext" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="horton.cext.Cell">
<em class="property">class </em><tt class="descclassname">horton.cext.</tt><tt class="descname">Cell</tt><a class="headerlink" href="#horton.cext.Cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Cell(ndarray rvecs=None)
Representation of periodic boundary conditions.</p>
<blockquote>
<div>0, 1, 2 and 3 dimensional systems are supported. The cell vectors need
not to be orthogonal.</div></blockquote>
<dl class="method">
<dt id="horton.cext.Cell.add_rvec">
<tt class="descname">add_rvec</tt><big>(</big><em>self</em>, <em>ndarray delta</em>, <em>ndarray r</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.add_rvec" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a linear combination of real cell vectors, <tt class="docutils literal"><span class="pre">r</span></tt>, to <tt class="docutils literal"><span class="pre">delta</span></tt> in-place</p>
</dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.dot_rvecs">
<tt class="descname">dot_rvecs</tt><big>(</big><em>self</em>, <em>ndarray cart</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.dot_rvecs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the corresponding dot product with the rvecs</p>
</dd></dl>

<dl class="staticmethod">
<dt id="horton.cext.Cell.from_hdf5">
<em class="property">static </em><tt class="descname">from_hdf5</tt><big>(</big><em>type cls</em>, <em>grp</em>, <em>lf</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="horton.cext.Cell.from_parameters">
<em class="property">static </em><tt class="descname">from_parameters</tt><big>(</big><em>type cls</em>, <em>lengths</em>, <em>angles</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.from_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a cell with the given parameters</p>
<p>The a vector is always parallel with the x-axis and they point in the
same direction. The b vector is always in the xy plane and points
towards the positive y-direction. The c vector points towards the
positive z-direction.</p>
<p>The number of elements in the lengths and angles arrays determines
the number of cell vectors. There are four cases:</p>
<ul class="simple">
<li>len(lengths) == 0 and len(angles) == 0: 0 rvecs</li>
<li>len(lengths) == 1 and len(angles) == 0: 1 rvecs</li>
<li>len(lengths) == 2 and len(angles) == 1: 2 rvecs</li>
<li>len(lengths) == 3 and len(angles) == 3: 3 rvecs</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.g_lincomb">
<tt class="descname">g_lincomb</tt><big>(</big><em>self</em>, <em>ndarray coeffs</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.g_lincomb" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a linear combination of reciprocal cell vectors</p>
</dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.get_glength">
<tt class="descname">get_glength</tt><big>(</big><em>self</em>, <em>int i</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.get_glength" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.get_gspacing">
<tt class="descname">get_gspacing</tt><big>(</big><em>self</em>, <em>int i</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.get_gspacing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.get_ranges_rcut">
<tt class="descname">get_ranges_rcut</tt><big>(</big><em>self</em>, <em>ndarray delta</em>, <em>double rcut</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.get_ranges_rcut" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the integer ranges for linear combinations of cell vectors.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>delta</dt>
<dd>The relative vector between two (interaction) centers</dd>
<dt>rcut</dt>
<dd>A cutoff radius</dd>
</dl>
<p>The returned ranges span the linear combination of cell vectors that
can be added to delta to obtain all periodic images within the cutoff
sphere centered at the origin.</p>
</dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.get_rlength">
<tt class="descname">get_rlength</tt><big>(</big><em>self</em>, <em>int i</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.get_rlength" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.get_rspacing">
<tt class="descname">get_rspacing</tt><big>(</big><em>self</em>, <em>int i</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.get_rspacing" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.cext.Cell.glengths">
<tt class="descname">glengths</tt><a class="headerlink" href="#horton.cext.Cell.glengths" title="Permalink to this definition">¶</a></dt>
<dd><p>The lengths of the reciprocal-space vectors.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.cext.Cell.gspacings">
<tt class="descname">gspacings</tt><a class="headerlink" href="#horton.cext.Cell.gspacings" title="Permalink to this definition">¶</a></dt>
<dd><p>The (orthogonal) spacing between opposite sides of the reciprocal-space unit cell.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.cext.Cell.gvecs">
<tt class="descname">gvecs</tt><a class="headerlink" href="#horton.cext.Cell.gvecs" title="Permalink to this definition">¶</a></dt>
<dd><p>The reciporcal-space cell vectors, layed out as rows.</p>
</dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.mic">
<tt class="descname">mic</tt><big>(</big><em>self</em>, <em>ndarray delta</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.mic" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply the minimum image convention to delta in-place</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.cext.Cell.nvec">
<tt class="descname">nvec</tt><a class="headerlink" href="#horton.cext.Cell.nvec" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of cell vectors</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.cext.Cell.parameters">
<tt class="descname">parameters</tt><a class="headerlink" href="#horton.cext.Cell.parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>The cell parameters (lengths and angles)</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.cext.Cell.rlengths">
<tt class="descname">rlengths</tt><a class="headerlink" href="#horton.cext.Cell.rlengths" title="Permalink to this definition">¶</a></dt>
<dd><p>The lengths of the real-space vectors.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.cext.Cell.rspacings">
<tt class="descname">rspacings</tt><a class="headerlink" href="#horton.cext.Cell.rspacings" title="Permalink to this definition">¶</a></dt>
<dd><p>The (orthogonal) spacing between opposite sides of the real-space unit cell.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.cext.Cell.rvecs">
<tt class="descname">rvecs</tt><a class="headerlink" href="#horton.cext.Cell.rvecs" title="Permalink to this definition">¶</a></dt>
<dd><p>The real-space cell vectors, layed out as rows.</p>
</dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.select_inside">
<tt class="descname">select_inside</tt><big>(</big><em>self</em>, <em>ndarray origin</em>, <em>ndarray center</em>, <em>double rcut</em>, <em>ndarray ranges_begin</em>, <em>ndarray ranges_end</em>, <em>ndarray shape</em>, <em>ndarray pbc</em>, <em>ndarray indexes</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.select_inside" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.to_cart">
<tt class="descname">to_cart</tt><big>(</big><em>self</em>, <em>ndarray frac</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.to_cart" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the corresponding Cartesian coordinates</p>
</dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.to_frac">
<tt class="descname">to_frac</tt><big>(</big><em>self</em>, <em>ndarray cart</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.to_frac" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the corresponding fractional coordinates</p>
</dd></dl>

<dl class="method">
<dt id="horton.cext.Cell.to_hdf5">
<tt class="descname">to_hdf5</tt><big>(</big><em>self</em>, <em>grp</em><big>)</big><a class="headerlink" href="#horton.cext.Cell.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.cext.Cell.volume">
<tt class="descname">volume</tt><a class="headerlink" href="#horton.cext.Cell.volume" title="Permalink to this definition">¶</a></dt>
<dd><p>The generalized volume of the unit cell (length, area or volume)</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="horton.cext.smart_wrap">
<tt class="descclassname">horton.cext.</tt><tt class="descname">smart_wrap</tt><big>(</big><em>long i</em>, <em>long shape</em>, <em>long pbc</em><big>)</big><a class="headerlink" href="#horton.cext.smart_wrap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="horton.cext.fill_cartesian_polynomials">
<tt class="descclassname">horton.cext.</tt><tt class="descname">fill_cartesian_polynomials</tt><big>(</big><em>ndarray output</em>, <em>long lmax</em><big>)</big><a class="headerlink" href="#horton.cext.fill_cartesian_polynomials" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the output vector with cartesian polynomials</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>output</dt>
<dd>A double precision numpy array where the first three values are
x, y and z coordinates.</dd>
<dt>lmax</dt>
<dd>The maximum angular momentum to compute.</dd>
</dl>
<p>The polynomials are stored according to the conventions set in
<tt class="docutils literal"><span class="pre">get_cartesian_powers</span></tt>.</p>
<p><strong>Returns:</strong></p>
<p>The index of the first element of the array that contains the polynomials
of the outermost shell.</p>
</dd></dl>

<dl class="function">
<dt id="horton.cext.fill_pure_polynomials">
<tt class="descclassname">horton.cext.</tt><tt class="descname">fill_pure_polynomials</tt><big>(</big><em>ndarray output</em>, <em>long lmax</em><big>)</big><a class="headerlink" href="#horton.cext.fill_pure_polynomials" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the output vector with pure polynomials</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>output</dt>
<dd>This can either be a double precission Numpy vector or 2D array. In
the first case, the first three values are z, x, and y coordinates.
In the second case, the first three columns contain z, x and y
coordinates.</dd>
<dt>lmax</dt>
<dd>The maximum angular momentum to compute.</dd>
</dl>
<p><strong>Returns:</strong></p>
<p>The index of the first element of the array that contains the polynomials
of the outermost shell.</p>
</dd></dl>

<dl class="function">
<dt id="horton.cext.fill_radial_polynomials">
<tt class="descclassname">horton.cext.</tt><tt class="descname">fill_radial_polynomials</tt><big>(</big><em>ndarray output</em>, <em>long lmax</em><big>)</big><a class="headerlink" href="#horton.cext.fill_radial_polynomials" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill the output vector with radial polynomials</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>output</dt>
<dd>A double precision numpy array where the first element is the radius</dd>
<dt>lmax</dt>
<dd>The maximum angular momentum to compute.</dd>
</dl>
<p>All elements after the first will be filled up with increasing powers of
the first element, up to lmax.</p>
</dd></dl>

<dl class="function">
<dt id="horton.cext.compute_grid_nucpot">
<tt class="descclassname">horton.cext.</tt><tt class="descname">compute_grid_nucpot</tt><big>(</big><em>ndarray numbers</em>, <em>ndarray coordinates</em>, <em>ndarray points</em>, <em>ndarray output</em><big>)</big><a class="headerlink" href="#horton.cext.compute_grid_nucpot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-horton.checkpoint">
<span id="horton-checkpoint-store-parts-of-a-system-object-in-a-checkpoint-file"></span><h2>6.3. <tt class="docutils literal"><span class="pre">horton.checkpoint</span></tt> &#8211; Store (parts of) a system object in a checkpoint file<a class="headerlink" href="#module-horton.checkpoint" title="Permalink to this headline">¶</a></h2>
<p>The philosophy of this module is to take away as much of the checkpointing
machinery out of the rest of Horton. The only (somewhat unavoidable)
exceptions to this philosophy are the <tt class="docutils literal"><span class="pre">load_checkpoint</span></tt> function in
<tt class="docutils literal"><span class="pre">horton.io</span></tt>, the <tt class="docutils literal"><span class="pre">from_hdf5</span></tt> and <tt class="docutils literal"><span class="pre">to_hdf5</span></tt> methods in several parts
of Horton and calls to System.update_chk in several parts of the code.</p>
<p>TODO: (long future) make the fields clever enough such that they can convert
data from one linalgfactory into another.</p>
<dl class="function">
<dt id="horton.checkpoint.load_hdf5_low">
<tt class="descclassname">horton.checkpoint.</tt><tt class="descname">load_hdf5_low</tt><big>(</big><em>item</em>, <em>lf</em><big>)</big><a class="headerlink" href="#horton.checkpoint.load_hdf5_low" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an object from an h5py object from a checkpoint file</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>item</dt>
<dd>A HD5 Dataset or group.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horton.checkpoint.dump_hdf5_low">
<tt class="descclassname">horton.checkpoint.</tt><tt class="descname">dump_hdf5_low</tt><big>(</big><em>grp</em>, <em>name</em>, <em>att</em><big>)</big><a class="headerlink" href="#horton.checkpoint.dump_hdf5_low" title="Permalink to this definition">¶</a></dt>
<dd><p>Low-level routine used to dump data to an HDF5 file.</p>
<dl class="docutils">
<dt>grp</dt>
<dd>A HDF5 group.</dd>
<dt>name</dt>
<dd>The name to be used for this object.</dd>
<dt>att</dt>
<dd>The object to be written.</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-horton.constants">
<span id="horton-constants-physicochemical-constants-in-atomic-units"></span><h2>6.4. <tt class="docutils literal"><span class="pre">horton.constants</span></tt> &#8211; Physicochemical constants in atomic units<a class="headerlink" href="#module-horton.constants" title="Permalink to this headline">¶</a></h2>
<p>These are the physical constants defined in this module (in atomic units):</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="47%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>avogadro</td>
<td>6.0221415000e+23</td>
</tr>
<tr class="row-odd"><td>boltzmann</td>
<td>3.1668154051e-06</td>
</tr>
<tr class="row-even"><td>lightspeed</td>
<td>1.3703599975e+02</td>
</tr>
<tr class="row-odd"><td>planck</td>
<td>6.2831853072e+00</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="module-horton.context">
<span id="horton-context-the-context-in-which-horton-is-used"></span><h2>6.5. <tt class="docutils literal"><span class="pre">horton.context</span></tt> &#8211; The context in which Horton is used<a class="headerlink" href="#module-horton.context" title="Permalink to this headline">¶</a></h2>
<p>This module controls global parameters that are purely technical, e.g. the
location of data files. It is certainly not meant to keep track of input
parameters for a computation.</p>
<p>This module contains a context object, an instance of the <a class="reference internal" href="#horton.context.Context" title="horton.context.Context"><tt class="xref py py-class docutils literal"><span class="pre">Context</span></tt></a>
class. For now, its functionality is rather limited. It tries to figure
out the location of the data directory. If it is not specified in the
environment variable <tt class="docutils literal"><span class="pre">HORTONDATA</span></tt>, it is assumed that the data is located
in a directory called <tt class="docutils literal"><span class="pre">data</span></tt>. If the data directory does not exist, an
error is raised.</p>
<dl class="class">
<dt id="horton.context.Context">
<em class="property">class </em><tt class="descclassname">horton.context.</tt><tt class="descname">Context</tt><a class="headerlink" href="#horton.context.Context" title="Permalink to this definition">¶</a></dt>
<dd><p>Finds out where the data directory is located etc.</p>
<p>The data directory contains data files with standard basis sets and
pseudo potentials.</p>
<dl class="method">
<dt id="horton.context.Context.get_fn">
<tt class="descname">get_fn</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#horton.context.Context.get_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the full path to the given filename in the data directory.</p>
</dd></dl>

<dl class="method">
<dt id="horton.context.Context.glob">
<tt class="descname">glob</tt><big>(</big><em>pattern</em><big>)</big><a class="headerlink" href="#horton.context.Context.glob" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all files in the data directory that match the given pattern.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-horton.exceptions">
<span id="horton-exceptions-definition-of-all-excpetions-in-horton"></span><h2>6.6. <tt class="docutils literal"><span class="pre">horton.exceptions</span></tt> &#8211; Definition of all excpetions in Horton<a class="headerlink" href="#module-horton.exceptions" title="Permalink to this headline">¶</a></h2>
<dl class="exception">
<dt id="horton.exceptions.ElectronCountError">
<em class="property">exception </em><tt class="descclassname">horton.exceptions.</tt><tt class="descname">ElectronCountError</tt><a class="headerlink" href="#horton.exceptions.ElectronCountError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when a negative number of electron is encountered, or
when more electrons than basis functions are requested.</p>
</dd></dl>

<dl class="exception">
<dt id="horton.exceptions.NoSCFConvergence">
<em class="property">exception </em><tt class="descclassname">horton.exceptions.</tt><tt class="descname">NoSCFConvergence</tt><a class="headerlink" href="#horton.exceptions.NoSCFConvergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when an SCF algorithm does not reach the convergence
threshold in the specified number of iterations</p>
</dd></dl>

<dl class="exception">
<dt id="horton.exceptions.SymmetryError">
<em class="property">exception </em><tt class="descclassname">horton.exceptions.</tt><tt class="descname">SymmetryError</tt><a class="headerlink" href="#horton.exceptions.SymmetryError" title="Permalink to this definition">¶</a></dt>
<dd><p>Exception raised when some symmetry algorithm fails</p>
</dd></dl>

</div>
<div class="section" id="module-horton.log">
<span id="horton-log-screen-logging-timing-and-citation-management"></span><h2>6.7. <tt class="docutils literal"><span class="pre">horton.log</span></tt> &#8211; Screen logging, timing and citation management<a class="headerlink" href="#module-horton.log" title="Permalink to this headline">¶</a></h2>
<p>The goal of the screen logger is to track the progress of a computation in
a convenient human-readable way, possibly higlighting problematic situations.
It is not intended as a computer-readable output file that contains all the
results of a computation. For that purpose, all useful information is
written to a binary checkpoint file or kept in memory as attributes of the
Horton objects.</p>
</div>
<div class="section" id="module-horton.matrix">
<span id="horton-matrix-two-and-four-dimensional-matrix-implementations"></span><h2>6.8. <tt class="docutils literal"><span class="pre">horton.matrix</span></tt> &#8211; Two- and four-dimensional matrix implementations<a class="headerlink" href="#module-horton.matrix" title="Permalink to this headline">¶</a></h2>
<p>The purpose of this module is to provide a generic API for different
implementations of real-valued double precision matrix storage and
operations.</p>
<p>Two-dimensional matrices are supposed to be symmetric and are used to
represent one-body operators and 1DRDMs. Four-dimensional matrices are used
to represent two-body operators, which are invariant under the following
interchanges of indexes:</p>
<div class="highlight-python"><pre>&lt;ij|kl&gt; = &lt;ji|lk&gt; = &lt;kl|ij&gt; = &lt;lk|ji&gt; =
&lt;il|kj&gt; = &lt;jk|li&gt; = &lt;kj|il&gt; = &lt;li|jk&gt;</pre>
</div>
<p>This module assumes physicists notation for the two-particle operators. It is
up to the specific implementations of the matrices to make use of these
symmetries.</p>
<p>One should use these matrix implementations without accessing the internals
of each class, i.e. without accessing attributes or methods that start with
an underscore.</p>
<p>In order to avoid temporaries when working with arrays, the methods do
not return arrays. Instead such methods are an in place operation or have
output arguments. This forces the user to allocate all memory in advance,
which can then be moved out of the loops. The initial implementation (the
Dense... classes) are just a proof of concept and may therefore contain
internals that still make temporaries. This fixed later with an alternative
implementation.</p>
<dl class="class">
<dt id="horton.matrix.LinalgFactory">
<em class="property">class </em><tt class="descclassname">horton.matrix.</tt><tt class="descname">LinalgFactory</tt><big>(</big><em>default_nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>A collection of compatible matrix and linear algebra routines.</p>
<p>This is just an abstract base class that serves as a template for
specific implementations.</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>default_nbasis</dt>
<dd>The default basis size when constructing new
operators/expansions.</dd>
</dl>
<dl class="method">
<dt id="horton.matrix.LinalgFactory.create_expansion">
<tt class="descname">create_expansion</tt><big>(</big><em>nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgFactory.create_expansion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgFactory.create_one_body">
<tt class="descname">create_one_body</tt><big>(</big><em>nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgFactory.create_one_body" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgFactory.create_two_body">
<tt class="descname">create_two_body</tt><big>(</big><em>nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgFactory.create_two_body" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgFactory.diagonalize">
<tt class="descname">diagonalize</tt><big>(</big><em>ham</em>, <em>overlap</em>, <em>expansion</em>, <em>epsilons</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgFactory.diagonalize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgFactory.error_eigen">
<tt class="descname">error_eigen</tt><big>(</big><em>ham</em>, <em>overlap</em>, <em>expansion</em>, <em>epsilons</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgFactory.error_eigen" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgFactory.get_memory_one_body">
<tt class="descname">get_memory_one_body</tt><big>(</big><em>nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgFactory.get_memory_one_body" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgFactory.get_memory_two_body">
<tt class="descname">get_memory_two_body</tt><big>(</big><em>nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgFactory.get_memory_two_body" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgFactory.set_default_nbasis">
<tt class="descname">set_default_nbasis</tt><big>(</big><em>nbasis</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgFactory.set_default_nbasis" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.LinalgObject">
<em class="property">class </em><tt class="descclassname">horton.matrix.</tt><tt class="descname">LinalgObject</tt><a class="headerlink" href="#horton.matrix.LinalgObject" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="horton.matrix.LinalgObject.apply_basis_permutation">
<tt class="descname">apply_basis_permutation</tt><big>(</big><em>permutation</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgObject.apply_basis_permutation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgObject.apply_basis_signs">
<tt class="descname">apply_basis_signs</tt><big>(</big><em>signs</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgObject.apply_basis_signs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgObject.assign">
<tt class="descname">assign</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgObject.assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgObject.clear">
<tt class="descname">clear</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.LinalgObject.clear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgObject.copy">
<tt class="descname">copy</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.LinalgObject.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="horton.matrix.LinalgObject.from_hdf5">
<em class="property">classmethod </em><tt class="descname">from_hdf5</tt><big>(</big><em>grp</em>, <em>lf</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgObject.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.LinalgObject.to_hdf5">
<tt class="descname">to_hdf5</tt><big>(</big><em>grp</em><big>)</big><a class="headerlink" href="#horton.matrix.LinalgObject.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.Expansion">
<em class="property">class </em><tt class="descclassname">horton.matrix.</tt><tt class="descname">Expansion</tt><big>(</big><em>nbasis</em>, <em>nfn=None</em><big>)</big><a class="headerlink" href="#horton.matrix.Expansion" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="horton.matrix.Expansion.check_normalization">
<tt class="descname">check_normalization</tt><big>(</big><em>olp</em>, <em>eps=0.0001</em><big>)</big><a class="headerlink" href="#horton.matrix.Expansion.check_normalization" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.OneBody">
<em class="property">class </em><tt class="descclassname">horton.matrix.</tt><tt class="descname">OneBody</tt><big>(</big><em>nbasis</em><big>)</big><a class="headerlink" href="#horton.matrix.OneBody" title="Permalink to this definition">¶</a></dt>
<dd><dl class="method">
<dt id="horton.matrix.OneBody.dot">
<tt class="descname">dot</tt><big>(</big><em>vec0</em>, <em>vec1</em><big>)</big><a class="headerlink" href="#horton.matrix.OneBody.dot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.OneBody.expectation_value">
<tt class="descname">expectation_value</tt><big>(</big><em>dm</em><big>)</big><a class="headerlink" href="#horton.matrix.OneBody.expectation_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.OneBody.get_element">
<tt class="descname">get_element</tt><big>(</big><em>i</em>, <em>j</em><big>)</big><a class="headerlink" href="#horton.matrix.OneBody.get_element" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.OneBody.iadd">
<tt class="descname">iadd</tt><big>(</big><em>other</em>, <em>factor=1</em><big>)</big><a class="headerlink" href="#horton.matrix.OneBody.iadd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.OneBody.iscale">
<tt class="descname">iscale</tt><big>(</big><em>factor</em><big>)</big><a class="headerlink" href="#horton.matrix.OneBody.iscale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.OneBody.itranspose">
<tt class="descname">itranspose</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.OneBody.itranspose" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.OneBody.set_element">
<tt class="descname">set_element</tt><big>(</big><em>i</em>, <em>j</em>, <em>value</em><big>)</big><a class="headerlink" href="#horton.matrix.OneBody.set_element" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.OneBody.trace">
<tt class="descname">trace</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.OneBody.trace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.DenseLinalgFactory">
<em class="property">class </em><tt class="descclassname">horton.matrix.</tt><tt class="descname">DenseLinalgFactory</tt><big>(</big><em>default_nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseLinalgFactory" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>default_nbasis</dt>
<dd>The default basis size when constructing new
operators/expansions.</dd>
</dl>
<dl class="method">
<dt id="horton.matrix.DenseLinalgFactory.create_expansion">
<tt class="descname">create_expansion</tt><big>(</big><em>nbasis=None</em>, <em>nfn=None</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseLinalgFactory.create_expansion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseLinalgFactory.create_one_body">
<tt class="descname">create_one_body</tt><big>(</big><em>nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseLinalgFactory.create_one_body" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseLinalgFactory.create_two_body">
<tt class="descname">create_two_body</tt><big>(</big><em>nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseLinalgFactory.create_two_body" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="horton.matrix.DenseLinalgFactory.diagonalize">
<em class="property">static </em><tt class="descname">diagonalize</tt><big>(</big><em>fock</em>, <em>overlap=None</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseLinalgFactory.diagonalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Generalized eigen solver for the given Hamiltonian and overlap.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>fock</dt>
<dd>A DenseOneBody Hamiltonian (or Fock) operator.</dd>
<dt>overlap</dt>
<dd>A DenseOneBody overlap operator.</dd>
</dl>
</dd></dl>

<dl class="staticmethod">
<dt id="horton.matrix.DenseLinalgFactory.error_eigen">
<em class="property">static </em><tt class="descname">error_eigen</tt><big>(</big><em>fock</em>, <em>overlap</em>, <em>expansion</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseLinalgFactory.error_eigen" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the error of the orbitals with respect to the eigenproblem</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>fock</dt>
<dd>A DenseOneBody Hamiltonian (or Fock) operator.</dd>
<dt>overlap</dt>
<dd>A DenseOneBody overlap operator.</dd>
<dt>expansion</dt>
<dd>An expansion object containing the current orbitals/eginvectors.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseLinalgFactory.get_memory_one_body">
<tt class="descname">get_memory_one_body</tt><big>(</big><em>nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseLinalgFactory.get_memory_one_body" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseLinalgFactory.get_memory_two_body">
<tt class="descname">get_memory_two_body</tt><big>(</big><em>nbasis=None</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseLinalgFactory.get_memory_two_body" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.DenseExpansion">
<em class="property">class </em><tt class="descclassname">horton.matrix.</tt><tt class="descname">DenseExpansion</tt><big>(</big><em>nbasis</em>, <em>nfn=None</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion" title="Permalink to this definition">¶</a></dt>
<dd><p>An expansion of several functions in a basis with a dense matrix of
coefficients. The implementation is such that the columns of self._array
contain the orbitals.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>nfn</dt>
<dd>The number of functions to store. Defaults to nbasis.</dd>
<dt>do_energies</dt>
<dd>Also allocate an array to store an energy corresponding to each
function.</dd>
</dl>
<dl class="method">
<dt id="horton.matrix.DenseExpansion.apply_basis_permutation">
<tt class="descname">apply_basis_permutation</tt><big>(</big><em>permutation</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.apply_basis_permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the coefficients for a given permutation of basis functions.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.apply_basis_signs">
<tt class="descname">apply_basis_signs</tt><big>(</big><em>signs</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.apply_basis_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for different sign conventions of the basis functions.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.assign">
<tt class="descname">assign</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.check_normalization">
<tt class="descname">check_normalization</tt><big>(</big><em>olp</em>, <em>eps=0.0001</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.check_normalization" title="Permalink to this definition">¶</a></dt>
<dd><p>Run an internal test to see if the orbitals are normalized</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>olp</dt>
<dd>The overlap one_body operators</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>eps</dt>
<dd>The allowed deviation from unity, very loose by default.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.clear">
<tt class="descname">clear</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.clear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.matrix.DenseExpansion.coeffs">
<tt class="descname">coeffs</tt><a class="headerlink" href="#horton.matrix.DenseExpansion.coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>The matrix with the expansion coefficients</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.compute_density_matrix">
<tt class="descname">compute_density_matrix</tt><big>(</big><em>dm</em>, <em>factor=None</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.compute_density_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the density matrix</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>dm</dt>
<dd>An output density matrix. This must be a DenseOneBody instance.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>factor</dt>
<dd>When given, the density matrix is added with the given prefactor
to the output argument. If not given, the original contents of
dm are overwritten.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.copy">
<tt class="descname">copy</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.derive_from_density_and_fock_matrix">
<tt class="descname">derive_from_density_and_fock_matrix</tt><big>(</big><em>dm</em>, <em>fock</em>, <em>overlap</em>, <em>scale=-0.001</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.derive_from_density_and_fock_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Arguments</strong>:</p>
<dl class="docutils">
<dt>dm</dt>
<dd>A DenseOneBody object with the density matrix</dd>
<dt>fock</dt>
<dd>A DenseOneBody object with the Fock matrix</dd>
<dt>overlap</dt>
<dd>A DenseOneBody object with the overlap matrix</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>scale</dt>
<dd>The linear coefficient for the density matrix. It is added to
the Fock matrix as in level shifting to obtain a set of orbitals
that diagonalizes both matrices.</dd>
</dl>
<p>This only works well for slater determinants without (fractional)
holes below the Fermi level.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.derive_from_fock_matrix">
<tt class="descname">derive_from_fock_matrix</tt><big>(</big><em>fock</em>, <em>overlap</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.derive_from_fock_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Diagonalize a Fock matrix to obtain orbitals and energies</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.derive_naturals">
<tt class="descname">derive_naturals</tt><big>(</big><em>dm</em>, <em>overlap</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.derive_naturals" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Arguments</strong>:</p>
<dl class="docutils">
<dt>dm</dt>
<dd>A DenseOneBody object with the density matrix</dd>
<dt>overlap</dt>
<dd>A DenseOneBody object with the overlap matrix</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.DenseExpansion.energies">
<tt class="descname">energies</tt><a class="headerlink" href="#horton.matrix.DenseExpansion.energies" title="Permalink to this definition">¶</a></dt>
<dd><p>The orbital energies</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.get_homo_energy">
<tt class="descname">get_homo_energy</tt><big>(</big><em>offset=0</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.get_homo_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a homo energy</p>
<p><strong>Optional arguments</strong>:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>By default, the (highest) homo energy is returned. When this
index is above zero, the corresponding lower homo energy is
returned.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.get_homo_index">
<tt class="descname">get_homo_index</tt><big>(</big><em>offset=0</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.get_homo_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of a HOMO orbital.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.get_lumo_energy">
<tt class="descname">get_lumo_energy</tt><big>(</big><em>offset=0</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.get_lumo_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a lumo energy</p>
<p><strong>Optional arguments</strong>:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>By default, the (lowest) lumo energy is returned. When this
index is above zero, the corresponding higher homo energy is
returned.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.get_lumo_index">
<tt class="descname">get_lumo_index</tt><big>(</big><em>offset=0</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.get_lumo_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the index of a LUMO orbital.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.DenseExpansion.homo_energy">
<tt class="descname">homo_energy</tt><a class="headerlink" href="#horton.matrix.DenseExpansion.homo_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a homo energy</p>
<p><strong>Optional arguments</strong>:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>By default, the (highest) homo energy is returned. When this
index is above zero, the corresponding lower homo energy is
returned.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.DenseExpansion.lumo_energy">
<tt class="descname">lumo_energy</tt><a class="headerlink" href="#horton.matrix.DenseExpansion.lumo_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a lumo energy</p>
<p><strong>Optional arguments</strong>:</p>
<dl class="docutils">
<dt>offset</dt>
<dd>By default, the (lowest) lumo energy is returned. When this
index is above zero, the corresponding higher homo energy is
returned.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.DenseExpansion.nbasis">
<tt class="descname">nbasis</tt><a class="headerlink" href="#horton.matrix.DenseExpansion.nbasis" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.DenseExpansion.nfn">
<tt class="descname">nfn</tt><a class="headerlink" href="#horton.matrix.DenseExpansion.nfn" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of orbitals (or functions in general)</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.DenseExpansion.occupations">
<tt class="descname">occupations</tt><a class="headerlink" href="#horton.matrix.DenseExpansion.occupations" title="Permalink to this definition">¶</a></dt>
<dd><p>The orbital occupations</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.read_from_hdf5">
<tt class="descname">read_from_hdf5</tt><big>(</big><em>grp</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.read_from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseExpansion.to_hdf5">
<tt class="descname">to_hdf5</tt><big>(</big><em>grp</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseExpansion.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.DenseOneBody">
<em class="property">class </em><tt class="descclassname">horton.matrix.</tt><tt class="descname">DenseOneBody</tt><big>(</big><em>nbasis</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody" title="Permalink to this definition">¶</a></dt>
<dd><p>Dense symmetric two-dimensional matrix, also used for density matrices.</p>
<p>This is the most inefficient implementation in terms of memory usage and
computer time. Due to its simplicity, it is trivial to implement. This
implementation mainly serves as a reference for testing purposes.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions.</dd>
</dl>
<dl class="method">
<dt id="horton.matrix.DenseOneBody.apply_basis_permutation">
<tt class="descname">apply_basis_permutation</tt><big>(</big><em>permutation</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.apply_basis_permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the coefficients for a given permutation of basis functions.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.apply_basis_signs">
<tt class="descname">apply_basis_signs</tt><big>(</big><em>signs</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.apply_basis_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for different sign conventions of the basis functions.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.assign">
<tt class="descname">assign</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.assign" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.check_symmetry">
<tt class="descname">check_symmetry</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.check_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the symmetry of the array. For testing only.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.clear">
<tt class="descname">clear</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets array to zeros element-wise.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.copy">
<tt class="descname">copy</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.distance">
<tt class="descname">distance</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Maximum difference between self and other one body object</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.dot">
<tt class="descname">dot</tt><big>(</big><em>vec0</em>, <em>vec1</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.dot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.expectation_value">
<tt class="descname">expectation_value</tt><big>(</big><em>dm</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.expectation_value" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="horton.matrix.DenseOneBody.from_hdf5">
<em class="property">classmethod </em><tt class="descname">from_hdf5</tt><big>(</big><em>grp</em>, <em>lf</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.get_element">
<tt class="descname">get_element</tt><big>(</big><em>i</em>, <em>j</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.get_element" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.iadd">
<tt class="descname">iadd</tt><big>(</big><em>other</em>, <em>factor=1</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.iadd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.idot">
<tt class="descname">idot</tt><big>(</big><em>other</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.idot" title="Permalink to this definition">¶</a></dt>
<dd><p>Inplace dot operator</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.iscale">
<tt class="descname">iscale</tt><big>(</big><em>factor</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.iscale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.itranspose">
<tt class="descname">itranspose</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.itranspose" title="Permalink to this definition">¶</a></dt>
<dd><p>In-place transpose</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.matrix.DenseOneBody.nbasis">
<tt class="descname">nbasis</tt><a class="headerlink" href="#horton.matrix.DenseOneBody.nbasis" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.read_from_hdf5">
<tt class="descname">read_from_hdf5</tt><big>(</big><em>grp</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.read_from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.set_element">
<tt class="descname">set_element</tt><big>(</big><em>i</em>, <em>j</em>, <em>value</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.set_element" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.to_hdf5">
<tt class="descname">to_hdf5</tt><big>(</big><em>grp</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseOneBody.trace">
<tt class="descname">trace</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.DenseOneBody.trace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.matrix.DenseTwoBody">
<em class="property">class </em><tt class="descclassname">horton.matrix.</tt><tt class="descname">DenseTwoBody</tt><big>(</big><em>nbasis</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody" title="Permalink to this definition">¶</a></dt>
<dd><p>Dense symmetric four-dimensional matrix.</p>
<p>This is the most inefficient implementation in terms of memory usage and
computer time. Due to its simplicity, it is trivial to implement. This
implementation mainly serves as a reference for testing purposes.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>nbasis</dt>
<dd>The number of basis functions.</dd>
</dl>
<dl class="method">
<dt id="horton.matrix.DenseTwoBody.apply_basis_permutation">
<tt class="descname">apply_basis_permutation</tt><big>(</big><em>permutation</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody.apply_basis_permutation" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorder the coefficients for a given permutation of basis functions.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseTwoBody.apply_basis_signs">
<tt class="descname">apply_basis_signs</tt><big>(</big><em>signs</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody.apply_basis_signs" title="Permalink to this definition">¶</a></dt>
<dd><p>Correct for different sign conventions of the basis functions.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseTwoBody.apply_direct">
<tt class="descname">apply_direct</tt><big>(</big><em>dm</em>, <em>output</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody.apply_direct" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the direct dot product with a density matrix.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseTwoBody.apply_exchange">
<tt class="descname">apply_exchange</tt><big>(</big><em>dm</em>, <em>output</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody.apply_exchange" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the exchange dot product with a density matrix.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseTwoBody.check_symmetry">
<tt class="descname">check_symmetry</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody.check_symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the symmetry of the array.</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseTwoBody.clear">
<tt class="descname">clear</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody.clear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="horton.matrix.DenseTwoBody.from_hdf5">
<em class="property">classmethod </em><tt class="descname">from_hdf5</tt><big>(</big><em>grp</em>, <em>lf</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseTwoBody.get_element">
<tt class="descname">get_element</tt><big>(</big><em>i</em>, <em>j</em>, <em>k</em>, <em>l</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody.get_element" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.matrix.DenseTwoBody.nbasis">
<tt class="descname">nbasis</tt><a class="headerlink" href="#horton.matrix.DenseTwoBody.nbasis" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of basis functions</p>
</dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseTwoBody.set_element">
<tt class="descname">set_element</tt><big>(</big><em>i</em>, <em>j</em>, <em>k</em>, <em>l</em>, <em>value</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody.set_element" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.matrix.DenseTwoBody.to_hdf5">
<tt class="descname">to_hdf5</tt><big>(</big><em>grp</em><big>)</big><a class="headerlink" href="#horton.matrix.DenseTwoBody.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-horton.moments">
<span id="horton-moments-auxiliary-routines-related-to-multipole-moments"></span><h2>6.9. <tt class="docutils literal"><span class="pre">horton.moments</span></tt> &#8211; Auxiliary routines related to multipole moments<a class="headerlink" href="#module-horton.moments" title="Permalink to this headline">¶</a></h2>
<p>This module fixes all the conventions with respect to multipole moments. Some
of the code below may (in some way) reoccur in the low-level routines. In any
case, such low-level code should be consistent with the conventions in this
module. See for example, horton.gobasis.cext.cart_to_pur_low.</p>
<dl class="function">
<dt id="horton.moments.get_cartesian_powers">
<tt class="descclassname">horton.moments.</tt><tt class="descname">get_cartesian_powers</tt><big>(</big><em>lmax</em><big>)</big><a class="headerlink" href="#horton.moments.get_cartesian_powers" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an ordered list of power for x, y and z up to angular moment lmax</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>lmax</dt>
<dd>The maximum angular momentum (0=s, 1=p, 2=d, ...)</dd>
</dl>
<p><strong>Returns:</strong> an array where each row corresponds to a multipole moment
and each column corresponds to a power of x, y and z respectively. The
rows are grouped per angular momentum, first s, them p, then d, and so
on. Within one angular momentum the rows are sorted &#8216;alphabetically&#8217;,
e.g. for l=2: xxx, xxy, xxz, xyy, xyz, xzz, yyy, yyz, yzz, zzz.</p>
</dd></dl>

<dl class="function">
<dt id="horton.moments.get_ncart">
<tt class="descclassname">horton.moments.</tt><tt class="descname">get_ncart</tt><big>(</big><em>l</em><big>)</big><a class="headerlink" href="#horton.moments.get_ncart" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of cartesian powers for a given angular momentum, l</p>
</dd></dl>

<dl class="function">
<dt id="horton.moments.get_ncart_cumul">
<tt class="descclassname">horton.moments.</tt><tt class="descname">get_ncart_cumul</tt><big>(</big><em>lmax</em><big>)</big><a class="headerlink" href="#horton.moments.get_ncart_cumul" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of cartesian powers up to a given angular momentum, lmax.</p>
</dd></dl>

<dl class="function">
<dt id="horton.moments.rotate_cartesian_moments">
<tt class="descclassname">horton.moments.</tt><tt class="descname">rotate_cartesian_moments</tt><big>(</big><em>moments</em>, <em>rmat</em><big>)</big><a class="headerlink" href="#horton.moments.rotate_cartesian_moments" title="Permalink to this definition">¶</a></dt>
<dd><p>Rotate cartesian moments</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>moments</dt>
<dd>A row vector with a series of cartesian multipole moments. Items in
this vector should follow the same order as defined by the function
<tt class="docutils literal"><span class="pre">get_cartesian_powers</span></tt>.</dd>
<dt>rmat</dt>
<dd>A (3,3) rotation matrix.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="horton.moments.get_npure">
<tt class="descclassname">horton.moments.</tt><tt class="descname">get_npure</tt><big>(</big><em>l</em><big>)</big><a class="headerlink" href="#horton.moments.get_npure" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of pure functions for a given angular momentum, l</p>
</dd></dl>

<dl class="function">
<dt id="horton.moments.get_npure_cumul">
<tt class="descclassname">horton.moments.</tt><tt class="descname">get_npure_cumul</tt><big>(</big><em>lmax</em><big>)</big><a class="headerlink" href="#horton.moments.get_npure_cumul" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of pure functions up to a given angular momentum, lmax.</p>
</dd></dl>

</div>
<div class="section" id="module-horton.periodic">
<span id="horton-periodic-periodic-table-of-elements"></span><h2>6.10. <tt class="docutils literal"><span class="pre">horton.periodic</span></tt> &#8211; Periodic table of elements<a class="headerlink" href="#module-horton.periodic" title="Permalink to this headline">¶</a></h2>
<p>This module contains an object <tt class="docutils literal"><span class="pre">periodic</span></tt> that can be used as a Pythonic
periodic table. It can be used as follows:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">horton</span> <span class="kn">import</span> <span class="n">periodic</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">periodic</span><span class="p">[</span><span class="s">&#39;si&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">number</span>
<span class="go">14</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">periodic</span><span class="p">[</span><span class="s">&#39;He&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">number</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">periodic</span><span class="p">[</span><span class="s">&#39;h&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span>
<span class="go">&#39;H&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">periodic</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span>
<span class="go">&#39;Li&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">periodic</span><span class="p">[</span><span class="s">&#39;5&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">symbol</span>
<span class="go">&#39;B&#39;</span>
</pre></div>
</div>
<dl class="class">
<dt id="horton.periodic.Element">
<em class="property">class </em><tt class="descclassname">horton.periodic.</tt><tt class="descname">Element</tt><big>(</big><em>number=None</em>, <em>symbol=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.periodic.Element" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents an element from the periodic table.</p>
<p>The following attributes are supported for all elements:</p>
<dl class="docutils">
<dt>number</dt>
<dd>The atomic number</dd>
<dt>symbol</dt>
<dd>A string with the symbol of the element.</dd>
</dl>
<p>The following attributes are present for some elements. When a parameter
is not known for a given element, the attribute is set to None.</p>
<dl class="docutils">
<dt>cov_radius_cordero</dt>
<dd>Covalent radius. B. Cordero, V. Gomez, A. E. Platero-Prats, M.
Reves, J. Echeverria, E. Cremades, F. Barragan, and S. Alvarez,
Dalton Trans. pp. 2832&#8211;2838 (2008), URL
<a class="reference external" href="http://dx.doi.org/10.1039/b801115j">http://dx.doi.org/10.1039/b801115j</a></dd>
<dt>cov_radius_bragg</dt>
<dd>Covalent radius. W. L. Bragg, Phil. Mag. 40, 169 (1920), URL
<a class="reference external" href="http://dx.doi.org/10.1080/14786440808636111">http://dx.doi.org/10.1080/14786440808636111</a></dd>
<dt>cov_radius_slater</dt>
<dd>Covalent radius. J. C. Slater, J. Chem. Phys. 41, 3199 (1964), URL
<a class="reference external" href="http://dx.doi.org/10.1063/1.1725697">http://dx.doi.org/10.1063/1.1725697</a></dd>
<dt>vdw_radius_bondi</dt>
<dd>van der Waals radius. A. Bondi, J. Phys. Chem. 68, 441 (1964), URL
<a class="reference external" href="http://dx.doi.org/10.1021/j100785a001">http://dx.doi.org/10.1021/j100785a001</a></dd>
<dt>vdw_radius_truhlar</dt>
<dd>van der Waals radius. M. Mantina A. C. Chamberlin R. Valero C. J.
Cramer D. G. Truhlar J. Phys. Chem. A 113 5806 (2009), URL
<a class="reference external" href="http://dx.doi.org/10.1021/jp8111556">http://dx.doi.org/10.1021/jp8111556</a></dd>
<dt>vdw_radius_rt</dt>
<dd>van der Waals radius. R. S. Rowland and R. Taylor, J. Phys. Chem.
100, 7384 (1996), URL <a class="reference external" href="http://dx.doi.org/10.1021/jp953141+">http://dx.doi.org/10.1021/jp953141+</a></dd>
<dt>vdw_radius_batsanov</dt>
<dd>van der Waals radius. S. S. Batsanov Inorganic Materials 37 871
(2001), URL <a class="reference external" href="http://dx.doi.org/10.1023/a%3a1011625728803">http://dx.doi.org/10.1023/a%3a1011625728803</a></dd>
<dt>vdw_radius_dreiding</dt>
<dd>van der Waals radius. Stephen L. Mayo, Barry D. Olafson, and William
A. Goddard III J. Phys. Chem. 94 8897 (1990), URL
<a class="reference external" href="http://dx.doi.org/10.1021/j100389a010">http://dx.doi.org/10.1021/j100389a010</a></dd>
<dt>vdw_radius_uff</dt>
<dd>van der Waals radius. A. K. Rappi, C. J. Casewit, K. S. Colwell, W.
A. Goddard III, and W. M. Skid J. Am. Chem. Soc. 114 10024 (1992),
URL <a class="reference external" href="http://dx.doi.org/10.1021/ja00051a040">http://dx.doi.org/10.1021/ja00051a040</a></dd>
<dt>vdw_radius_mm3</dt>
<dd>van der Waals radius. N. L. Allinger, X. Zhou, and J. Bergsma,
Journal of Molecular Structure: THEOCHEM 312, 69 (1994),
<a class="reference external" href="http://dx.doi.org/10.1016/s0166-1280(09)80008-0">http://dx.doi.org/10.1016/s0166-1280(09)80008-0</a></dd>
<dt>wc_radius</dt>
<dd>Waber-Cromer radius of the outermost orbital maximum. J. T. Waber
and D. T. Cromer, J. Chem. Phys. 42, 4116 (1965), URL
<a class="reference external" href="http://dx.doi.org/10.1063/1.1695904">http://dx.doi.org/10.1063/1.1695904</a></dd>
<dt>cr_radius</dt>
<dd>Clementi-Raimondi radius. E. Clementi, D. L. Raimondi, W. P.
Reinhardt, J. Chem. Phys. 47, 1300 (1967), URL
<a class="reference external" href="http://dx.doi.org/10.1063/1.1712084">http://dx.doi.org/10.1063/1.1712084</a></dd>
</dl>
<p>The following attribute is derived from the data given above:</p>
<dl class="docutils">
<dt>cov_radius:</dt>
<dd>equals cov_radius_cordero</dd>
<dt>vdw_radius:</dt>
<dd>vdw_radius_truhlar if present
else vdw_radius_bondi if present
else vdw_radius_batsanov if present
else vdw_radius_mm3 if present
else None</dd>
<dt>becke_radius:</dt>
<dd>cov_radius_slater if present
else cov_radius_cordero if present
else None</dd>
</dl>
<dl class="attribute">
<dt id="horton.periodic.Element.attribute_names">
<tt class="descname">attribute_names</tt><em class="property"> = ['cov_radius_cordero', 'cov_radius_bragg', 'cov_radius_slater', 'vdw_radius_bondi', 'vdw_radius_truhlar', 'vdw_radius_rt', 'vdw_radius_batsanov', 'vdw_radius_dreiding', 'vdw_radius_uff', 'vdw_radius_mm3', 'wc_radius', 'cr_radius']</em><a class="headerlink" href="#horton.periodic.Element.attribute_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="horton.periodic.Periodic">
<em class="property">class </em><tt class="descclassname">horton.periodic.</tt><tt class="descname">Periodic</tt><big>(</big><em>elements</em><big>)</big><a class="headerlink" href="#horton.periodic.Periodic" title="Permalink to this definition">¶</a></dt>
<dd><p>A periodic table data structure.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>elements</dt>
<dd>A list of <a class="reference internal" href="#horton.periodic.Element" title="horton.periodic.Element"><tt class="xref py py-class docutils literal"><span class="pre">Element</span></tt></a> instances.</dd>
</dl>
<dl class="method">
<dt id="horton.periodic.Periodic.__getitem__">
<tt class="descname">__getitem__</tt><big>(</big><em>index</em><big>)</big><a class="headerlink" href="#horton.periodic.Periodic.__getitem__" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an element from the table based on a flexible index.</p>
<p><strong>Argument:</strong></p>
<dl class="docutils">
<dt>index</dt>
<dd>This can be either an integer atomic number, a string with the
elemental symbol (any case), or a string with the atomic number.</dd>
</dl>
<p><strong>Returns:</strong> the corresponding <a class="reference internal" href="#horton.periodic.Element" title="horton.periodic.Element"><tt class="xref py py-class docutils literal"><span class="pre">Element</span></tt></a> instance</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-horton.quadprog">
<span id="horton-quadprog-a-light-weight-quadratic-programming-solver"></span><h2>6.11. <tt class="docutils literal"><span class="pre">horton.quadprog</span></tt> &#8211; A light-weight quadratic programming solver<a class="headerlink" href="#module-horton.quadprog" title="Permalink to this headline">¶</a></h2>
<p>Problems of the following type can be solved:</p>
<div class="math">
<p><img src="../_images/math/511968f9d2ac1173e65a49e566ec8e3699595326.png" alt="min_{x} \frac{1}{2} x^T A x - b^T x \\
R x = s
x \ge 0"/></p>
</div><p>This is not the most general type of quadratic programming but it is
sufficient for the needs in Horton.</p>
<p>The equality constraints are optional. When A is positive definite, a
polynomial-scaling interior point algorithm can be used:
<tt class="docutils literal"><span class="pre">QPSolver.find_local</span></tt>. If A has negative eigenvalues, only the brute force
solver is reliable but it&#8217;s cost scales exponentially with problem size.</p>
<p>No a priori feasibility tests are carried out and it is assumed that in
<tt class="docutils literal"><span class="pre">QPSolver.find_local</span></tt> one is able to provide a feasible initial guess. The
routine <tt class="docutils literal"><span class="pre">QPSolver.find_brute</span></tt> will complain a posteriori if the problem
is infeasible.</p>
<p>When A is negative definite, the solution may be unbounded. In the
<tt class="docutils literal"><span class="pre">QPSolver.find_local</span></tt> algorithm, this will lead to a convergence failure
in a limited number of steps. In <cite>QPSolver.find_brute`</cite>, this situation is
properly detected.</p>
<p>In summary, it is assumed that one only works with well-behaved problems.
Issues with feasibilty and boundedness are not always handled smoothly.</p>
<div class="section" id="notation">
<h3>6.11.1. Notation<a class="headerlink" href="#notation" title="Permalink to this headline">¶</a></h3>
<p>The following naming conventions are used:</p>
<dl class="docutils">
<dt>free</dt>
<dd>Refers to the components of the solution that is not constrained to
zero. The variable free is always an array with booleans indicating
which components are free (True) or frozen (False).</dd>
<dt>frozen</dt>
<dd>Opposite of free.</dd>
<dt>x</dt>
<dd>A solution vector</dd>
<dt>nx</dt>
<dd>The dimension of the solution vector</dd>
<dt>nl</dt>
<dd>The number of constraints</dd>
</dl>
<dl class="class">
<dt id="horton.quadprog.QPSolver">
<em class="property">class </em><tt class="descclassname">horton.quadprog.</tt><tt class="descname">QPSolver</tt><big>(</big><em>a</em>, <em>b</em>, <em>r=None</em>, <em>s=None</em>, <em>eps=1e-10</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver" title="Permalink to this definition">¶</a></dt>
<dd><p>A Quadratic Programming Solver</p>
<p>The problem is defined as follows;</p>
<div class="math">
<p><img src="../_images/math/511968f9d2ac1173e65a49e566ec8e3699595326.png" alt="min_{x} \frac{1}{2} x^T A x - b^T x \\
R x = s
x \ge 0"/></p>
</div><p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>a</dt>
<dd>The symmetric matrix <img class="math" src="../_images/math/4f1a3b62092db42cd06fe4dbec2bfc5983c147c8.png" alt="A \in \mathbb{R}^{n \times n}" style="vertical-align: -1px"/></dd>
<dt>b</dt>
<dd>The column vector <img class="math" src="../_images/math/e1cf7be1c9550af01a6b979e1d1339006e98a8bc.png" alt="b \in \mathbb{R}^n" style="vertical-align: -1px"/>.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>r</dt>
<dd>The matrix with constraint coefficients, <img class="math" src="../_images/math/025e46412c0fe4ef60f0ac144afa6b18733df862.png" alt="R \in \mathbb{R}^{l \times n}" style="vertical-align: -1px"/>.</dd>
<dt>s</dt>
<dd>The matrix with constraint targets, <img class="math" src="../_images/math/e0cea2d7be7ea78b23b5c85689fd917b9e5e3f52.png" alt="s \in \mathbb{R}^l" style="vertical-align: -1px"/>.</dd>
<dt>eps</dt>
<dd>A general threshold used for several purposes, e.g. the validity
of a solution.</dd>
</dl>
<dl class="method">
<dt id="horton.quadprog.QPSolver.check_feasible">
<tt class="descname">check_feasible</tt><big>(</big><em>x</em>, <em>free=None</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.check_feasible" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a solution, x, matches the constraints</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>x</dt>
<dd>The solution to test</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>free</dt>
<dd>When given, it is assumed that the fixed variables must be zero
and that the rest can be anything (also negative). When not
given, all components of x must be zero or positive.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.quadprog.QPSolver.check_solution">
<tt class="descname">check_solution</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.check_solution" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a solution, x, is a valid local minimum</p>
</dd></dl>

<dl class="method">
<dt id="horton.quadprog.QPSolver.compute_cn">
<tt class="descname">compute_cn</tt><big>(</big><em>free</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.compute_cn" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the condition number of the problem.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>free</dt>
<dd>Boolean array with the free components.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.quadprog.QPSolver.compute_cost">
<tt class="descname">compute_cost</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.compute_cost" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the function to be minimized for the given x</p>
</dd></dl>

<dl class="method">
<dt id="horton.quadprog.QPSolver.find_brute">
<tt class="descname">find_brute</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.find_brute" title="Permalink to this definition">¶</a></dt>
<dd><p>Brute force solution of the quadratic programming problem</p>
<p><strong>Returns:</strong></p>
<dl class="docutils">
<dt>cost</dt>
<dd>The value of the cost function at the solution</dd>
<dt>x</dt>
<dd>The solution vector</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.quadprog.QPSolver.find_local">
<tt class="descname">find_local</tt><big>(</big><em>x</em>, <em>trust_radius</em>, <em>maxiter=None</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.find_local" title="Permalink to this definition">¶</a></dt>
<dd><p>A local solver for the quadratic programming problem</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>x</dt>
<dd>The initial guess for the solution. This must be a feasible
point.</dd>
<dt>trust_radius</dt>
<dd>The maximum step size. This can be fairly large.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>maxiter</dt>
<dd>The maximum number of iterations, this is 10*nx by default.</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="docutils">
<dt>cost</dt>
<dd>The value of the cost function at the solution</dd>
<dt>x</dt>
<dd>The solution vector</dd>
</dl>
<p>Note that this local search will always lead to the global optimum if
the matrix <img class="math" src="../_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A" style="vertical-align: 0px"/> is positive definite.</p>
</dd></dl>

<dl class="method">
<dt id="horton.quadprog.QPSolver.get_free_problem">
<tt class="descname">get_free_problem</tt><big>(</big><em>free</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.get_free_problem" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the matrix a, b, r and s without the frozen columns/rows</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>free</dt>
<dd>Boolean array with the free components</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="docutils">
<dt>a2</dt>
<dd>The coefficients of the free system, including rows and colums
for the lagrange multipliers.</dd>
<dt>b2</dt>
<dd>The right-hand side of the equations, including the targets of
the equations.</dd>
<dt>nfree</dt>
<dd>The number of equations due to free components of x.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.quadprog.QPSolver.get_rmsds">
<tt class="descname">get_rmsds</tt><big>(</big><em>x</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.get_rmsds" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantify how far x deviates from a local solution</p>
<p><strong>Returns:</strong></p>
<dl class="docutils">
<dt>gradient</dt>
<dd>The gradient projected onto the equality constraints, if any.</dd>
<dt>rmsd_free</dt>
<dd>The gradient RMSD for the non-zero components</dd>
<dt>rmsd_frozen</dt>
<dd>The gradient RMSD for the zero components. Only contributions
from negative components are included.</dd>
<dt>rmsd_neg</dt>
<dd>The rmsd of the negative components of the solution.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.quadprog.QPSolver.log">
<tt class="descname">log</tt><big>(</big><em>x=None</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Print out the qps for debugging purposes</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>x</dt>
<dd>An solution vector (that causes problems).</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.quadprog.QPSolver.nl">
<tt class="descname">nl</tt><a class="headerlink" href="#horton.quadprog.QPSolver.nl" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of constraints</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.quadprog.QPSolver.nx">
<tt class="descname">nx</tt><a class="headerlink" href="#horton.quadprog.QPSolver.nx" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of unkowns</p>
</dd></dl>

<dl class="method">
<dt id="horton.quadprog.QPSolver.solve">
<tt class="descname">solve</tt><big>(</big><em>free</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the problem, keeping certain components fixed at zero</p>
<p>The equality constraints are honored. However, free components may
become negative. Fixed components are internally excluded from the
equations and their result is manually set to zero.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>free</dt>
<dd>Boolean array with the free components</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.quadprog.QPSolver.solve_radius">
<tt class="descname">solve_radius</tt><big>(</big><em>free</em>, <em>center</em>, <em>radius</em><big>)</big><a class="headerlink" href="#horton.quadprog.QPSolver.solve_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the equations, keeping certain components fixed at zero, with maximum radius.</p>
<p>The equality constraints are honored. However, free components may
become negative. Fixed components are internally excluded from the
equations and their result is manually set to zero.</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>free</dt>
<dd>Boolean array with the free components</dd>
<dt>center</dt>
<dd>The center of the restraint, a vector with length nx. (<img class="math" src="../_images/math/17f1249ad95b7682b8316ad21de8ce4ee9fdcf93.png" alt="x_0" style="vertical-align: -3px"/>)</dd>
<dt>radius</dt>
<dd>The maximum Euclidean distance of the returned solution x from
the given center</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-horton.symmetry">
<span id="horton-symmetry-geometric-symmetries"></span><h2>6.12. <tt class="docutils literal"><span class="pre">horton.symmetry</span></tt> &#8211; Geometric symmetries<a class="headerlink" href="#module-horton.symmetry" title="Permalink to this headline">¶</a></h2>
<p>The symmetry tools in Horton are just meant to provide optional additional
information on top of a System instance.</p>
<dl class="class">
<dt id="horton.symmetry.Symmetry">
<em class="property">class </em><tt class="descclassname">horton.symmetry.</tt><tt class="descname">Symmetry</tt><big>(</big><em>name</em>, <em>generators</em>, <em>fracs</em>, <em>numbers</em>, <em>cell</em>, <em>labels=None</em><big>)</big><a class="headerlink" href="#horton.symmetry.Symmetry" title="Permalink to this definition">¶</a></dt>
<dd><p>An optional symmetry descriptor for Horton System objects</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>name</dt>
<dd>Whatever name you want to give to this symmetry. This is
converted to a string.</dd>
<dt>generators</dt>
<dd>A list of (3,4) matrices where the first three columns contain
the linear transformation matrix and the last column is a
translation vector. These transformations act on the fractional
(or reduced) coordinates.</dd>
<dt>fracs</dt>
<dd>The fractional coordinates of a primitive cell/unit.</dd>
<dt>numbers</dt>
<dd>The corresponding element numbers of the primitive cell/unit</dd>
<dt>cell</dt>
<dd>A Cell object. Even for isolated systems a cell object must
be provided with nvec=0.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>labels</dt>
<dd>A list of unique labels for each atom in the primitive unit.
These are generated from the numbers array when not given.</dd>
</dl>
<dl class="attribute">
<dt id="horton.symmetry.Symmetry.cell">
<tt class="descname">cell</tt><a class="headerlink" href="#horton.symmetry.Symmetry.cell" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.symmetry.Symmetry.fracs">
<tt class="descname">fracs</tt><a class="headerlink" href="#horton.symmetry.Symmetry.fracs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="horton.symmetry.Symmetry.from_hdf5">
<em class="property">classmethod </em><tt class="descname">from_hdf5</tt><big>(</big><em>grp</em>, <em>lf</em><big>)</big><a class="headerlink" href="#horton.symmetry.Symmetry.from_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a Symmetry object from a HDF5 group</p>
</dd></dl>

<dl class="method">
<dt id="horton.symmetry.Symmetry.generate">
<tt class="descname">generate</tt><big>(</big><em>threshold=0.001</em><big>)</big><a class="headerlink" href="#horton.symmetry.Symmetry.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a system object</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>threshold</dt>
<dd>When, after transformation with the generators, two (or more)
symmetry atoms overlap within this threshold, they will be
merged into one. The distance is measured in Cartesian
coordinates.</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="docutils">
<dt>coordinates</dt>
<dd>Cartesian coordinates for all atoms.</dd>
<dt>numbers</dt>
<dd>Element numbers for all atoms.</dd>
<dt>links</dt>
<dd>An array of indexes to connect each atom back with an atom in
the primitive cell (first column) and a generator (second
column).</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.symmetry.Symmetry.generators">
<tt class="descname">generators</tt><a class="headerlink" href="#horton.symmetry.Symmetry.generators" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.symmetry.Symmetry.identify">
<tt class="descname">identify</tt><big>(</big><em>system</em>, <em>threshold=0.1</em><big>)</big><a class="headerlink" href="#horton.symmetry.Symmetry.identify" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect atoms in the primitive unit with atoms in the system object</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>system</dt>
<dd>A system object where to atoms (with some minor deviation)
adhere to this symmetry.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>threshold</dt>
<dd>The maximum allowed distance between the ideal atom position
and the actual atom position</dd>
</dl>
<p><strong>Returns:</strong></p>
<dl class="docutils">
<dt>links</dt>
<dd>An array of indexes to connect each atom back with an atom in
the primitive cell (first column) and a generator (second
column).</dd>
</dl>
<p>If an atom in the System object can not be linked with an atom in
the primitive unit, a SymmetryError is raised. If the system contains
less atoms (e.g. a vacancy) than the perfect crystal, this method
will not complain.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.symmetry.Symmetry.labels">
<tt class="descname">labels</tt><a class="headerlink" href="#horton.symmetry.Symmetry.labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.symmetry.Symmetry.name">
<tt class="descname">name</tt><a class="headerlink" href="#horton.symmetry.Symmetry.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.symmetry.Symmetry.natom">
<tt class="descname">natom</tt><a class="headerlink" href="#horton.symmetry.Symmetry.natom" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of atoms in the primitive unit</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.symmetry.Symmetry.numbers">
<tt class="descname">numbers</tt><a class="headerlink" href="#horton.symmetry.Symmetry.numbers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.symmetry.Symmetry.to_hdf5">
<tt class="descname">to_hdf5</tt><big>(</big><em>grp</em><big>)</big><a class="headerlink" href="#horton.symmetry.Symmetry.to_hdf5" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a symmetry object to an HDF5 group</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-horton.system">
<span id="horton-system-molecular-system-and-all-aspects-relevant-for-a-computation"></span><h2>6.13. <tt class="docutils literal"><span class="pre">horton.system</span></tt> &#8211; Molecular system and all aspects relevant for a computation<a class="headerlink" href="#module-horton.system" title="Permalink to this headline">¶</a></h2>
<p>Objects of the System class specify the geometry (and atomic elements) of the
molecule on which Horton will perform a computation. Also other parameters
that determine several aspects of the molecular wavefunction, are attributes
of a <a class="reference internal" href="#horton.system.System" title="horton.system.System"><tt class="xref py py-class docutils literal"><span class="pre">System</span></tt></a> instance, e.g. basis sets, pseudo-potentials, ghost atoms,
etc.</p>
<dl class="class">
<dt id="horton.system.System">
<em class="property">class </em><tt class="descclassname">horton.system.</tt><tt class="descname">System</tt><big>(</big><em>coordinates</em>, <em>numbers</em>, <em>obasis=None</em>, <em>grid=None</em>, <em>wfn=None</em>, <em>lf=None</em>, <em>cache=None</em>, <em>extra=None</em>, <em>cell=None</em>, <em>pseudo_numbers=None</em>, <em>chk=None</em><big>)</big><a class="headerlink" href="#horton.system.System" title="Permalink to this definition">¶</a></dt>
<dd><p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>coordinates</dt>
<dd>A (N, 3) float numpy array with Cartesian coordinates of the
atoms.</dd>
<dt>numbers</dt>
<dd>A (N,) int numpy vector with the atomic numbers.</dd>
</dl>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>obasis</dt>
<dd>A string or an instance of either the basis set or basis set
description classes, e.g. &#8216;STO-3G&#8217;, GOBasisDesc(&#8216;STO-3G&#8217;), ...
for the orbitals.</dd>
<dt>grid</dt>
<dd>A grid object used for molecular integration.</dd>
<dt>wfn</dt>
<dd>A wavefunction object.</dd>
<dt>lf</dt>
<dd>A LinalgFactory instance. When not given, a DenseLinalgFactory
is used by default.</dd>
<dt>cache</dt>
<dd><p class="first">A cache object with computed results that depend on other
attributes of the system class. Cached items should be tagged
according to the attributes they depend on:</p>
<blockquote>
<div><ul class="simple">
<li><tt class="docutils literal"><span class="pre">o</span></tt>: obasis</li>
<li><tt class="docutils literal"><span class="pre">c</span></tt>: coordinates</li>
<li><tt class="docutils literal"><span class="pre">g</span></tt>: grid</li>
</ul>
</div></blockquote>
<p class="last">When given as a dictionary, each value must consist of two
items: the object to be cached and the tags.</p>
</dd>
<dt>extra</dt>
<dd>A dictionary with additional information about the system. The
keys must be strings.</dd>
<dt>cell</dt>
<dd>A Cell object that describes the (generally triclinic) periodic
boundary conditions. So far, this is nearly nowhere supported in
Horton, so don&#8217;t get too excited.</dd>
<dt>pseudo_numbers</dt>
<dd>The core charges of the pseudo potential, if applicable</dd>
<dt>chk</dt>
<dd>A filename for the checkpoint file or an open h5.File object.
If the file does not exist yet, it will be created. If the file
already exists, it must be an HDF5 file that is structured
such that it adheres to the format that Horton creates itself.
If chk is an open h5.File object, it will not be closed when the
System instance is deleted.</dd>
</dl>
<dl class="method">
<dt id="horton.system.System.assign_chk">
<tt class="descname">assign_chk</tt><big>(</big><em>chk</em><big>)</big><a class="headerlink" href="#horton.system.System.assign_chk" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.system.System.cache">
<tt class="descname">cache</tt><a class="headerlink" href="#horton.system.System.cache" title="Permalink to this definition">¶</a></dt>
<dd><p>A cache of intermediate results that depend on the coordinates</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.cell">
<tt class="descname">cell</tt><a class="headerlink" href="#horton.system.System.cell" title="Permalink to this definition">¶</a></dt>
<dd><p>A Cell object describing the periodic boundary conditions.</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.charge">
<tt class="descname">charge</tt><a class="headerlink" href="#horton.system.System.charge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.system.System.chk">
<tt class="descname">chk</tt><a class="headerlink" href="#horton.system.System.chk" title="Permalink to this definition">¶</a></dt>
<dd><p>A <tt class="docutils literal"><span class="pre">h5.File</span></tt> instance used as checkpoint file or <tt class="docutils literal"><span class="pre">None</span></tt></p>
</dd></dl>

<dl class="method">
<dt id="horton.system.System.compute_grid_density">
<tt class="descname">compute_grid_density</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.compute_grid_density" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.compute_grid_density_fock">
<tt class="descname">compute_grid_density_fock</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.compute_grid_density_fock" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.compute_grid_esp">
<tt class="descname">compute_grid_esp</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.compute_grid_esp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.compute_grid_gradient">
<tt class="descname">compute_grid_gradient</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.compute_grid_gradient" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.compute_grid_gradient_fock">
<tt class="descname">compute_grid_gradient_fock</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.compute_grid_gradient_fock" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.compute_grid_hartree">
<tt class="descname">compute_grid_hartree</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.compute_grid_hartree" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.compute_grid_orbitals">
<tt class="descname">compute_grid_orbitals</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.compute_grid_orbitals" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.compute_nucnuc">
<tt class="descname">compute_nucnuc</tt><big>(</big><big>)</big><a class="headerlink" href="#horton.system.System.compute_nucnuc" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute interaction energy of the nuclei</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.coordinates">
<tt class="descname">coordinates</tt><a class="headerlink" href="#horton.system.System.coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>The positions of the nuclei</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.extra">
<tt class="descname">extra</tt><a class="headerlink" href="#horton.system.System.extra" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary with extra properties of the system.</p>
</dd></dl>

<dl class="classmethod">
<dt id="horton.system.System.from_file">
<em class="property">classmethod </em><tt class="descname">from_file</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a System object from a file.</p>
<p>A list of filenames may be provided, which will be loaded in that
order. Each file complements or overrides the information loaded
from a previous file in the list. Furthermore, keyword arguments
may be used to specify additional constructor arguments.</p>
<p>The <tt class="docutils literal"><span class="pre">lf</span></tt> optional argument is picked up from the kwargs list to
contstruct (when needed) arrays to store the results loaded from
file. When <tt class="docutils literal"><span class="pre">lf</span></tt> is not given, a DenseLinalgFactory is created by
default.</p>
<p>The filenames may also contain checkpoint files and open h5.File
objects of checkpoint files. The last such checkpoint file will
automatically be used as a checkpoint file for this class. If you
want to override this behavior, provide the <tt class="docutils literal"><span class="pre">chk</span></tt> keyword argument
(may be None).</p>
</dd></dl>

<dl class="method">
<dt id="horton.system.System.get_electron_repulsion">
<tt class="descname">get_electron_repulsion</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.get_electron_repulsion" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.get_kinetic">
<tt class="descname">get_kinetic</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.get_kinetic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.get_nuclear_attraction">
<tt class="descname">get_nuclear_attraction</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.get_nuclear_attraction" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.get_overlap">
<tt class="descname">get_overlap</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#horton.system.System.get_overlap" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="horton.system.System.grid">
<tt class="descname">grid</tt><a class="headerlink" href="#horton.system.System.grid" title="Permalink to this definition">¶</a></dt>
<dd><p>The integration grid</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.lf">
<tt class="descname">lf</tt><a class="headerlink" href="#horton.system.System.lf" title="Permalink to this definition">¶</a></dt>
<dd><p>The LinalgFactory for this system</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.natom">
<tt class="descname">natom</tt><a class="headerlink" href="#horton.system.System.natom" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of atoms</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.numbers">
<tt class="descname">numbers</tt><a class="headerlink" href="#horton.system.System.numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>An array with the atomic numbers</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.obasis">
<tt class="descname">obasis</tt><a class="headerlink" href="#horton.system.System.obasis" title="Permalink to this definition">¶</a></dt>
<dd><p>The orbital basis</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.obasis_desc">
<tt class="descname">obasis_desc</tt><a class="headerlink" href="#horton.system.System.obasis_desc" title="Permalink to this definition">¶</a></dt>
<dd><p>The orbital basis description</p>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.pseudo_numbers">
<tt class="descname">pseudo_numbers</tt><a class="headerlink" href="#horton.system.System.pseudo_numbers" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="horton.system.System.to_file">
<tt class="descname">to_file</tt><big>(</big><em>filename</em><big>)</big><a class="headerlink" href="#horton.system.System.to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the system to a file</p>
<p><strong>Arguments:</strong></p>
<dl class="docutils">
<dt>filename</dt>
<dd>The name of the file to write to. The extension of the file
is used to determine the file format.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.system.System.update_chk">
<tt class="descname">update_chk</tt><big>(</big><em>field_name=None</em><big>)</big><a class="headerlink" href="#horton.system.System.update_chk" title="Permalink to this definition">¶</a></dt>
<dd><p>Write (a part of) the system to the checkpoint file.</p>
<p><strong>Optional Argument:</strong></p>
<dl class="docutils">
<dt>field</dt>
<dd>A field string that specifies which part must be written to the
checkpoint file. When not given, all possible fields are
written. The latter is only useful in specific cases, e.g. upon
initialization of the system. The available field names are
specified in the attribute register dictionary in the
module <tt class="docutils literal"><span class="pre">horton.checkpoint</span></tt>.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.system.System.update_coordinates">
<tt class="descname">update_coordinates</tt><big>(</big><em>coordinates=None</em><big>)</big><a class="headerlink" href="#horton.system.System.update_coordinates" title="Permalink to this definition">¶</a></dt>
<dd><p>Update all attributes that depend on coodinates and clear related parts of cache</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>coordinates</dt>
<dd>The new atomic coordinates</dd>
</dl>
<p>When one wants to set new coordintes, one may also edit the
system.coordinates array in-place and then call this method without
any arguments.</p>
</dd></dl>

<dl class="method">
<dt id="horton.system.System.update_grid">
<tt class="descname">update_grid</tt><big>(</big><em>grid=None</em><big>)</big><a class="headerlink" href="#horton.system.System.update_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a new integration grid and clear related parts of the cache</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>grid</dt>
<dd>The new integration grid. When not given, it is assumed that
the grid was modified in-place and that only derived results in
the cache need to be pruned.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="horton.system.System.update_obasis">
<tt class="descname">update_obasis</tt><big>(</big><em>obasis=None</em><big>)</big><a class="headerlink" href="#horton.system.System.update_obasis" title="Permalink to this definition">¶</a></dt>
<dd><p>Regenerate the orbital basis and clear all attributes that depend on it.</p>
<p><strong>Optional arguments:</strong></p>
<dl class="docutils">
<dt>obasis</dt>
<dd>The new basis. This may be a string or an instance of GOBasis or
GOBasisDesc. When not given, the orbital basis description
stored in the system object (_obasis_desc attribute) will be
used.</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="horton.system.System.wfn">
<tt class="descname">wfn</tt><a class="headerlink" href="#horton.system.System.wfn" title="Permalink to this definition">¶</a></dt>
<dd><p>The wavefunction</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-horton.units">
<span id="horton-units-conversion-from-and-to-atomic-units"></span><h2>6.14. <tt class="docutils literal"><span class="pre">horton.units</span></tt> &#8211; Conversion from and to atomic units<a class="headerlink" href="#module-horton.units" title="Permalink to this headline">¶</a></h2>
<p>Internally Horton always uses atomic units. Atomic units are consistent,
similar to the SI unit system: one does not need conversion factors in the
middle of a computation. This choice facilitates the programming and reduces
accidental bugs.</p>
<p>References for the conversion values:</p>
<ul class="simple">
<li>B. J. Mohr and B. N. Taylor,
CODATA recommended values of the fundamental physical
constants: 1998, Rev. Mod. Phys. 72(2), 351 (2000)</li>
<li>The NIST Reference on Constants, Units, and Uncertainty
(<a class="reference external" href="http://physics.nist.gov/cuu/Constants/index.html">http://physics.nist.gov/cuu/Constants/index.html</a>)</li>
<li>1 calorie = 4.184 Joules</li>
</ul>
<p><strong>Conventions followed by this module:</strong></p>
<p>Let foo be is the value of an external unit in internal (atomic) units. The
way to use this unit is as follows: <tt class="docutils literal"><span class="pre">5*foo</span></tt> litterally means <cite>five times
foo</cite>. The result of this operation is a floating point number for this value
in atomic units.</p>
<p><strong>Examples:</strong></p>
<p>If you want to have a distance of five angstrom in internal units:
<tt class="docutils literal"><span class="pre">5*angstrom</span></tt>.</p>
<p>If you want to convert a length of 5 internal units to angstrom:
<tt class="docutils literal"><span class="pre">5/angstrom</span></tt>.</p>
<p><strong>Remarks:</strong></p>
<p>It is highly recommended to perform unit conversions only when data is read
from the input or data is written to the output. It may also be useful in
<cite>input scripts</cite> that use Horton. Do not perform any unit conversion in other
parts of the program.</p>
<p>An often recurring question is how to convert a frequency in internal units
to a spectroscopic wavenumber in inverse centimeters. This is how it can be
done:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">horton</span> <span class="kn">import</span> <span class="n">centimeter</span><span class="p">,</span> <span class="n">lightspeed</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">invcm</span> <span class="o">=</span> <span class="n">lightspeed</span><span class="o">/</span><span class="n">centimeter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="mf">0.00320232</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">freq</span><span class="o">/</span><span class="n">invcm</span>
</pre></div>
</div>
<p>These are the conversion constants defined in this module:</p>
<blockquote>
<div><table border="1" class="docutils">
<colgroup>
<col width="47%" />
<col width="53%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ampere</td>
<td>1.5097490095e+02</td>
</tr>
<tr class="row-odd"><td>amu</td>
<td>1.8228886274e+03</td>
</tr>
<tr class="row-even"><td>angstrom</td>
<td>1.8897261339e+00</td>
</tr>
<tr class="row-odd"><td>atm</td>
<td>3.4439674262e-09</td>
</tr>
<tr class="row-even"><td>au</td>
<td>1.0000000000e+00</td>
</tr>
<tr class="row-odd"><td>avogadro</td>
<td>6.0221415000e+23</td>
</tr>
<tr class="row-even"><td>bar</td>
<td>3.3989315828e-09</td>
</tr>
<tr class="row-odd"><td>calorie</td>
<td>9.5968941808e+17</td>
</tr>
<tr class="row-even"><td>centimeter</td>
<td>1.8897261339e+08</td>
</tr>
<tr class="row-odd"><td>coulomb</td>
<td>6.2415097445e+18</td>
</tr>
<tr class="row-even"><td>debye</td>
<td>3.9343031369e-01</td>
</tr>
<tr class="row-odd"><td>decimeter</td>
<td>1.8897261339e+09</td>
</tr>
<tr class="row-even"><td>deg</td>
<td>1.7453292520e-02</td>
</tr>
<tr class="row-odd"><td>electronvolt</td>
<td>3.6749325920e-02</td>
</tr>
<tr class="row-even"><td>femtosecond</td>
<td>4.1341373337e+01</td>
</tr>
<tr class="row-odd"><td>gram</td>
<td>1.0977693253e+27</td>
</tr>
<tr class="row-even"><td>hertz</td>
<td>2.4188843265e-17</td>
</tr>
<tr class="row-odd"><td>joule</td>
<td>2.2937127583e+17</td>
</tr>
<tr class="row-even"><td>kcalmol</td>
<td>1.5936015753e-03</td>
</tr>
<tr class="row-odd"><td>kelvin</td>
<td>1.0000000000e+00</td>
</tr>
<tr class="row-even"><td>kilogram</td>
<td>1.0977693253e+30</td>
</tr>
<tr class="row-odd"><td>kjmol</td>
<td>3.8087991760e-04</td>
</tr>
<tr class="row-even"><td>liter</td>
<td>6.7483345942e+27</td>
</tr>
<tr class="row-odd"><td>meter</td>
<td>1.8897261339e+10</td>
</tr>
<tr class="row-even"><td>micrometer</td>
<td>1.8897261339e+04</td>
</tr>
<tr class="row-odd"><td>miligram</td>
<td>1.0977693253e+24</td>
</tr>
<tr class="row-even"><td>milimeter</td>
<td>1.8897261339e+07</td>
</tr>
<tr class="row-odd"><td>mol</td>
<td>6.0221415000e+23</td>
</tr>
<tr class="row-even"><td>nanometer</td>
<td>1.8897261339e+01</td>
</tr>
<tr class="row-odd"><td>nanosecond</td>
<td>4.1341373337e+07</td>
</tr>
<tr class="row-even"><td>newton</td>
<td>1.2137805141e+07</td>
</tr>
<tr class="row-odd"><td>pascal</td>
<td>3.3989315828e-14</td>
</tr>
<tr class="row-even"><td>picometer</td>
<td>1.8897261339e-02</td>
</tr>
<tr class="row-odd"><td>picosecond</td>
<td>4.1341373337e+04</td>
</tr>
<tr class="row-even"><td>rad</td>
<td>1.0000000000e+00</td>
</tr>
<tr class="row-odd"><td>rydberg</td>
<td>5.0000000000e-01</td>
</tr>
<tr class="row-even"><td>second</td>
<td>4.1341373337e+16</td>
</tr>
<tr class="row-odd"><td>unified</td>
<td>1.8228886274e+03</td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<div class="section" id="horton-cell-h">
<h2>6.15. <tt class="docutils literal"><span class="pre">horton/cell.h</span></tt><a class="headerlink" href="#horton-cell-h" title="Permalink to this headline">¶</a></h2>
<p></p>
<p></p>
<em>Functions</em><blockquote>
<div><p id=""><span id="hortoncell_8h_1aa102ffffe0b1fafe708dda5965dbb474"></span><div class="line-block">
<div class="line">long <strong>smart_wrap</strong>(long i, long shape, long pbc)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
</div></blockquote>
<p><p id="hortonclassCell"><em>class</em> <strong>Cell</strong></p>
<blockquote>
<div><p></p>
<p></p>
<em>Public Functions</em><blockquote>
<div><p id=""><span id="hortonclassCell_1acba60bc86e7336b6cbea07dfded1f394"></span><div class="line-block">
<div class="line"> <strong>Cell</strong>(double * _rvecs, int _nvec)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1aecd473afb7ad60a9ab3655ed2cb06a2c"></span><div class="line-block">
<div class="line">void <strong>mic</strong>(double * delta)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a1de3ed96861a3c780d31984aec2bac22"></span><div class="line-block">
<div class="line">void <strong>to_frac</strong>(double * cart, double * frac)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a0cbd27c88ad06d614f5145ce9be33827"></span><div class="line-block">
<div class="line">void <strong>to_cart</strong>(double * frac, double * cart)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a9ec0ba73617944fd913dbcd49570bb06"></span><div class="line-block">
<div class="line">void <strong>g_lincomb</strong>(double * coeffs, double * gvec)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a711aaec89c83cb316669593e4e091059"></span><div class="line-block">
<div class="line">void <strong>dot_rvecs</strong>(double * cart, double * dot_rvecs)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a9edb1f2cff83266b6a9c860d46da113e"></span><div class="line-block">
<div class="line">void <strong>add_rvec</strong>(double * delta, long * r)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1aebe614f908599bf1aad6361f51571487"></span><div class="line-block">
<div class="line">int <strong>get_nvec</strong>()</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a80b3e8832a6b37e95d06765b4086825e"></span><div class="line-block">
<div class="line">double <strong>get_volume</strong>()</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a79c230c812e279adf4a96d813260a3e9"></span><div class="line-block">
<div class="line">double <strong>get_rspacing</strong>(int i)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a663372aad6039ea5c93f937ec22468f5"></span><div class="line-block">
<div class="line">double <strong>get_gspacing</strong>(int i)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a801bcd88067923ed5b1fc35eed78e1e7"></span><div class="line-block">
<div class="line">double <strong>get_rlength</strong>(int i)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a1cd37e847dfb40fd990c6b10bf24466a"></span><div class="line-block">
<div class="line">double <strong>get_glength</strong>(int i)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a5a33a7b77c630cadf65608d165ae4dd0"></span><div class="line-block">
<div class="line">void <strong>copy_rvecs</strong>(double * _rvecs)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1abaddb6e5f95d87c5288d5124ea8dd397"></span><div class="line-block">
<div class="line">void <strong>copy_gvecs</strong>(double * _gvecs)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a775513d43f2ec2eb970c2050a0ae7416"></span><div class="line-block">
<div class="line">void <strong>copy_rlengths</strong>(double * _rlengths)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a2835b6a84c66a19112827f7fb08c69d0"></span><div class="line-block">
<div class="line">void <strong>copy_glengths</strong>(double * _glengths)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1abf60187441f67f2a819f793089d8a90c"></span><div class="line-block">
<div class="line">void <strong>copy_rspacings</strong>(double * _rspacings)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1aafc8268e7a1541d13a4576407e3fce3c"></span><div class="line-block">
<div class="line">void <strong>copy_gspacings</strong>(double * _gspacings)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a04e2c024b965160175bc04371fd7ec95"></span><div class="line-block">
<div class="line">void <strong>set_ranges_rcut</strong>(double * delta, double rcut, long * ranges_begin, long * ranges_end)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a60251b71fb52f01830e0e1bded5cfd65"></span><div class="line-block">
<div class="line">long <strong>select_inside</strong>(double * origin, double * center, double rcut, long * ranges_begin, long * ranges_end, long * shape, long * pbc, long * indexes)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
</div></blockquote>
<em>Private Members</em><blockquote>
<div><p id=""><span id="hortonclassCell_1ad4dad19e58413b6451c653faeba2c516"></span>double <strong>rvecs</strong>[9]</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1ae33fa1c1c83f50dc0fe2c65710e86ff0"></span>double <strong>gvecs</strong>[9]</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a32eddc1a92a5dd2deb90a45ed3d32ff5"></span>double <strong>rlengths</strong>[3]</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a6c06751e57b86865bb71da41b36077fc"></span>double <strong>glengths</strong>[3]</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a9ee24297008f631e395c1b3a2e43d120"></span>double <strong>rspacings</strong>[3]</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a8557b866247b23a607dd1e195152e44d"></span>double <strong>gspacings</strong>[3]</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a426862431a79984cb040c6f396a8e1d9"></span>double <strong>volume</strong></p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonclassCell_1a7da51560e9a66761526cfd7c87e2daec"></span>int <strong>nvec</strong></p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
</div></blockquote>
</div></blockquote>
</p>
</div>
<div class="section" id="horton-moments-h">
<h2>6.16. <tt class="docutils literal"><span class="pre">horton/moments.h</span></tt><a class="headerlink" href="#horton-moments-h" title="Permalink to this headline">¶</a></h2>
<p></p>
<p></p>
<em>Functions</em><blockquote>
<div><p id=""><span id="hortonmoments_8h_1a10d0fabc5fcc7466b1629781df38e289"></span><div class="line-block">
<div class="line">long <strong>fill_cartesian_polynomials</strong>(double * output, long lmax)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonmoments_8h_1ad06045cd3e4c3b026c8102c4942c9907"></span><div class="line-block">
<div class="line">long <strong>fill_pure_polynomials</strong>(double * output, long lmax)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonmoments_8h_1a44b0263e0168b6ae06c8c5434ec5ed8f"></span><div class="line-block">
<div class="line">long <strong>fill_pure_polynomials_array</strong>(double * output, long lmax, long nrep, long stride)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
<p id=""><span id="hortonmoments_8h_1abc38a4c11ecda82c51e59b53d8e2c3ba"></span><div class="line-block">
<div class="line">void <strong>fill_radial_polynomials</strong>(double * output, long lmax)</div>
</div>
</p>
<blockquote>
<div><p></p>
<p></p>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="horton-nucpot-h">
<h2>6.17. <tt class="docutils literal"><span class="pre">horton/nucpot.h</span></tt><a class="headerlink" href="#horton-nucpot-h" title="Permalink to this headline">¶</a></h2>
<p></p>
<p></p>
<em>Functions</em><blockquote>
<div><p id=""><span id="hortonnucpot_8h_1a8be083ad149b529600ad3e6c3b0dad32"></span><div class="line-block">
<div class="line">void <strong>compute_grid_nucpot</strong>(long * numbers, double * coordinates, long natom, double * points, double * output, long npoint)</div>
</div>
</p>
<blockquote>
<div><p>Compute the electrostatic potential due to the nuclei on a grid. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><tt class="first docutils literal"><span class="pre">numbers</span></tt> - <p>The pointer to an array with atomic numbers. This array contains natom elements.</p>
</li>
<li><tt class="first docutils literal"><span class="pre">coordinates</span></tt> - <p>The pointer to an array with atomic coordinates. This array contains 3*natom elements of an (atom,3) array in row-major ordering.</p>
</li>
<li><tt class="first docutils literal"><span class="pre">natom</span></tt> - <p>The number of atoms.</p>
</li>
<li><tt class="first docutils literal"><span class="pre">points</span></tt> - <p>The pointer to the array with coordinates of the grid points. This array contains 3*npoint elements of an (npoint,3) array in row-major ordering.</p>
</li>
<li><tt class="first docutils literal"><span class="pre">output</span></tt> - <p>The pointer to the output array. This array constins npoint elements.</p>
</li>
<li><tt class="first docutils literal"><span class="pre">npoint</span></tt> - <p>The number of grid points. </p>
</li>
</ul>
</dd>
</dl>
</p>
</div></blockquote>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">6. <tt class="docutils literal"><span class="pre">horton</span></tt> &#8211; The main Horton Package</a><ul>
<li><a class="reference internal" href="#module-horton.cache">6.1. <tt class="docutils literal"><span class="pre">horton.cache</span></tt> &#8211; Avoid recomputation of earlier results and reallocation of existing arrays</a></li>
<li><a class="reference internal" href="#module-horton.cext">6.2. <tt class="docutils literal"><span class="pre">horton.cext</span></tt> &#8211; C++ extensions</a></li>
<li><a class="reference internal" href="#module-horton.checkpoint">6.3. <tt class="docutils literal"><span class="pre">horton.checkpoint</span></tt> &#8211; Store (parts of) a system object in a checkpoint file</a></li>
<li><a class="reference internal" href="#module-horton.constants">6.4. <tt class="docutils literal"><span class="pre">horton.constants</span></tt> &#8211; Physicochemical constants in atomic units</a></li>
<li><a class="reference internal" href="#module-horton.context">6.5. <tt class="docutils literal"><span class="pre">horton.context</span></tt> &#8211; The context in which Horton is used</a></li>
<li><a class="reference internal" href="#module-horton.exceptions">6.6. <tt class="docutils literal"><span class="pre">horton.exceptions</span></tt> &#8211; Definition of all excpetions in Horton</a></li>
<li><a class="reference internal" href="#module-horton.log">6.7. <tt class="docutils literal"><span class="pre">horton.log</span></tt> &#8211; Screen logging, timing and citation management</a></li>
<li><a class="reference internal" href="#module-horton.matrix">6.8. <tt class="docutils literal"><span class="pre">horton.matrix</span></tt> &#8211; Two- and four-dimensional matrix implementations</a></li>
<li><a class="reference internal" href="#module-horton.moments">6.9. <tt class="docutils literal"><span class="pre">horton.moments</span></tt> &#8211; Auxiliary routines related to multipole moments</a></li>
<li><a class="reference internal" href="#module-horton.periodic">6.10. <tt class="docutils literal"><span class="pre">horton.periodic</span></tt> &#8211; Periodic table of elements</a></li>
<li><a class="reference internal" href="#module-horton.quadprog">6.11. <tt class="docutils literal"><span class="pre">horton.quadprog</span></tt> &#8211; A light-weight quadratic programming solver</a><ul>
<li><a class="reference internal" href="#notation">6.11.1. Notation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-horton.symmetry">6.12. <tt class="docutils literal"><span class="pre">horton.symmetry</span></tt> &#8211; Geometric symmetries</a></li>
<li><a class="reference internal" href="#module-horton.system">6.13. <tt class="docutils literal"><span class="pre">horton.system</span></tt> &#8211; Molecular system and all aspects relevant for a computation</a></li>
<li><a class="reference internal" href="#module-horton.units">6.14. <tt class="docutils literal"><span class="pre">horton.units</span></tt> &#8211; Conversion from and to atomic units</a></li>
<li><a class="reference internal" href="#horton-cell-h">6.15. <tt class="docutils literal"><span class="pre">horton/cell.h</span></tt></a></li>
<li><a class="reference internal" href="#horton-moments-h">6.16. <tt class="docutils literal"><span class="pre">horton/moments.h</span></tt></a></li>
<li><a class="reference internal" href="#horton-nucpot-h">6.17. <tt class="docutils literal"><span class="pre">horton/nucpot.h</span></tt></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../ref_literature.html"
                        title="previous chapter">5. Literature</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="horton_espfit.html"
                        title="next chapter">7. <tt class="docutils literal"><span class="pre">horton.espfit</span></tt> &#8211; Electrostatic potential fitting</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/lib/horton.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="horton_espfit.html" title="7. horton.espfit – Electrostatic potential fitting"
             >next</a> |</li>
        <li class="right" >
          <a href="../ref_literature.html" title="5. Literature"
             >previous</a> |</li>
        <li><a href="../index.html">Horton 1.2.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Toon Verstraelen.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>