

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Getting Started &mdash; Horton v0.0 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Horton v0.0 documentation" href="index.html" />
    <link rel="next" title="Milestones" href="dev_milestones.html" />
    <link rel="prev" title="Theoretical background" href="tut_theory.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dev_milestones.html" title="Milestones"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tut_theory.html" title="Theoretical background"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Horton v0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>This chapter discusses all the technology and conventions that make it fun to
work on Horton with a small team, and to make sure things remain manageable
as the elephant grows bigger and bigger.</p>
<div class="section" id="coding-guidelines">
<h2>Coding guidelines<a class="headerlink" href="#coding-guidelines" title="Permalink to this headline">¶</a></h2>
<p>Although the development of Horton is a rather informal business, it is not a
bad idea to follow some guidelines to guarantee the quality of the program. It
may feel a bit frustrating in the beginning, but it avoids a lot of frustration
in the long run. These guidelines assume you are familiar with the revision
system, with Python in general, and know how to test to code. (vide infra)</p>
<ol class="arabic">
<li><p class="first"><strong>Write validation routines for new pieces of code. Commit new code and tests
in one patch.</strong></p>
<p>Writing tests is difficult, but really necessary. Only fools believe they can
write bug-free code without testing. It always takes some creativity to
devise test routines, certainly in Horton. Some examples are given below, but
feel free to blur the lines. Just make sure a test does not take too long to
execute (i.e. not more than a second).</p>
<ul class="simple">
<li>Check whether a computational result is translational invariant.</li>
<li>Compare energies from atomic computations with published results, or
results obtained with other (reliable) programs.</li>
<li>Compare analytical derivatives with finite differences.</li>
<li>Compare the output of a routine with a results derived on paper.</li>
</ul>
<p>In most cases, it is sufficient to imagine what <cite>could</cite> go wrong if your new
code <cite>would</cite> be buggy.</p>
<p><em>Important:</em> Avoid tests that just check the output of a routine with the output
from a previous version of the code. Such tests need to be redone each time
a bug is found in that routine.</p>
</li>
<li><p class="first"><strong>Never commit a patch that breaks the tests.</strong></p>
<p>The purpose of the tests is to keep the program working as we add more
features. When a patch breaks previous tests, it is simply unacceptable.</p>
</li>
<li><p class="first"><strong>Ask someone to review your patches before they go into the official master
branch.</strong></p>
<p>It is perfectly OK to work in your own branch and do there whatever you like.
It is also OK to upload these branches to the central repository, such that
others can see and review your code. As soon as one of your branches is
mature enough, use <tt class="docutils literal"><span class="pre">git</span> <span class="pre">rebase</span></tt> to apply your patches to the master branch.</p>
</li>
<li><p class="first"><strong>When you find a bug, first write a test that fails because of the bug. Then
fix the bug. Commit both test and fix in one patch.</strong></p>
<p>This is a great way of fixing bugs and making tests. It also guarantees that
the bug you found will not be reintroduced accidentally in later versions of
Horton.</p>
</li>
<li><p class="first"><strong>Write lots of documentation, doc-strings and comments.</strong></p>
<p><cite>Comments</cite> are needed for obvious reasons.</p>
<p><cite>Doc-strings</cite> are a rather Pythonic thing to do. More information about
doc-strings can be found <a class="reference external" href="http://www.python.org/dev/peps/pep-0257#what-is-a-docstring">here</a>.</p>
<p><cite>The documentation</cite> is written in <a class="reference external" href="http://docutils.sourceforge.net/rst.html">ReStructuredText</a>
and compiled with <a class="reference external" href="http://sphinx.pocoo.org/">Sphinx</a> into the fancy
webpage you are currently looking at. More details on the documentation
system are given below.</p>
</li>
<li><p class="first"><strong>Write Python code in style.</strong></p>
<p>There is an extensive <a class="reference external" href="http://www.python.org/dev/peps/pep-0008/">Style Guide for Python Code</a>.
The main purpose is to make the source code easier to read and maintain.
These are the basics:</p>
<ul>
<li><p class="first">Never use tabs. Always use four spaces to indent code.</p>
</li>
<li><p class="first">Use CamelCase for class names. All other names are written in lower case,
with underscores to separate different words in a name.</p>
</li>
<li><p class="first">Separate top-level blocks in a module by two blank lines.</p>
</li>
<li><p class="first">Separate methods in a class with one blank line.</p>
</li>
<li><dl class="first docutils">
<dt>Doc-strings also have a specific format:</dt>
<dd><ol class="first last arabic simple">
<li>A one-line summary, followed by a blank line.</li>
<li>Description of the arguments, followed by a blank line.</li>
<li>Description of the return value(s), followed by a blank line.
(optional)</li>
<li>Some extra paragraphs with detailed information. (optional)</li>
</ol>
</dd>
</dl>
</li>
<li><p class="first">Use self-explaining names for classes, variables, functions, methods. Start
functions and methods with a verb.</p>
</li>
<li><p class="first">Never use <tt class="docutils literal"><span class="pre">from</span> <span class="pre">foo</span> <span class="pre">import</span> <span class="pre">*</span></tt> in a Horton module. Always specify what is
to be imported, or use the <tt class="docutils literal"><span class="pre">import</span> <span class="pre">foo</span></tt> or <tt class="docutils literal"><span class="pre">import</span> <span class="pre">foo</span> <span class="pre">as</span> <span class="pre">bar</span></tt> syntax.</p>
</li>
<li><p class="first">Avoid long lines, i.e. no longer than 80 characters. Use the line-wrapping
features in Python to break long lines into smaller ones.</p>
</li>
</ul>
<p>Specific conventions for Horton</p>
<ul class="simple">
<li>Import the Numpy package as follows: <tt class="docutils literal"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></tt>.</li>
</ul>
</li>
</ol>
</div>
<div class="section" id="git-the-fast-version-control-system">
<h2>Git: the fast version control system<a class="headerlink" href="#git-the-fast-version-control-system" title="Permalink to this headline">¶</a></h2>
<p>Horton uses <a class="reference external" href="http://git-scm.com/">Git</a> for version control.</p>
<p>Because a few of us are new to version control systems (VCSs), I&#8217;ll go through
the basics. Although the commands below are specific for Git, most of the
good practices are general and also apply to other modern VCSs such Bazaar
or Mercurial. There are however a few old-fashioned systems such as CVS (and to
some extent Subversion), that do not (or only poorly) support some of the
guidelines below. Of all the VCSs out there, Git is probably the most snappy, and
definitely the most popular for new projects. Git is also the only widely
adopted open-source VCS for the development of commercial software.</p>
<p>The purpose of a VCS is to allow many different people to make modifications in the same
program without messing things up. VCS software also makes life much easier for
someone who has to merge different developments into one common source tree.
With the help of a few good practices, it becomes even unnecessary to have a
codemeister at all.</p>
<div class="section" id="configuring-git">
<h3>Configuring Git<a class="headerlink" href="#configuring-git" title="Permalink to this headline">¶</a></h3>
<p>Make a file ~/.gitconfig as follows:</p>
<div class="highlight-python"><pre>[user]
    name = Toon Verstraelen
    email = Toon.Verstraelen@UGent.be

[color]
    diff = always
    status = always
    interactive = always
    branch = always

[branch "master"]
    remote = origin
    merge = master

[push]
    default = matching</pre>
</div>
<p>Replace my name and email by yours. Add the following to your <tt class="docutils literal"><span class="pre">.bashrc</span></tt>,
and modify to your taste:</p>
<div class="highlight-python"><pre>GITPS1='$(__git_ps1 ":%s")'
SILVER="\[\033[0;37m\]"
GRAY="\[\033[1;30m\]"
GREEN="\[\033[1;32m\]"
BLUE="\[\033[1;34m\]"
YELLOW="\[\033[1;33m\]"
RS="\[\033[00m\]"

export PROMPT_DIRTRIM=3
export PS1="${GREEN}\u@\h${RS} ${BLUE}\w${RS}${YELLOW}${GITPS1}${BLUE}&gt;${RS} "</pre>
</div>
<p>With these settings, the bash prompt will show what <cite>branch</cite> you are working on.
It will become clear later what that means.</p>
</div>
<div class="section" id="some-terminology">
<h3>Some terminology<a class="headerlink" href="#some-terminology" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>Patch</dt>
<dd>A set of changes in the source code. These are typically recorded in a
<cite>patch</cite> file. Such a file specifies a set of lines that are removed and
a set of lines that are added.</dd>
<dt><a class="reference external" href="http://en.wikipedia.org/wiki/SHA-1">SHA-1</a> hash</dt>
<dd>A <cite>numerical</cite> checksum of a given length in bytes (in this case 256) for a
much larger amount of data, e.g. a very long character string. One tries to
design hashing algorithms such that they are doing two things very well: (i) it
is not possible to derive the original data from a hash and (ii) a small
change in the original data completely changes the hash. The <a class="reference external" href="http://en.wikipedia.org/wiki/MD5">MD5</a> checksum is
well known and often used from CD images, but it is not great in terms of
the above two hashing objectives.</dd>
<dt>Commit (git specific)</dt>
<dd>A patch with a some extra information: author, timestamp, a SHA1 hash of the
code to which it applies, and some other things.</dd>
<dt>Branch</dt>
<dd><p class="first">A series of commits that describe the history of the source code.</p>
<p class="last">In realistic projects, the source code history is not linear, but contains
many deviations from the <cite>official branch</cite> where people try to implement a
new feature. It is however useful to have only one official linear history.
We will show below how this can be done with git.</p>
</dd>
<dt>Branch head</dt>
<dd>The last commit in a branch.</dd>
</dl>
</div>
<div class="section" id="adding-a-feature">
<h3>Adding a feature<a class="headerlink" href="#adding-a-feature" title="Permalink to this headline">¶</a></h3>
<p>The steps below assume that you already have cloned the repository earlier. Only
the basic work flow is discussed, so things may become more complicated.</p>
<ol class="arabic">
<li><p class="first">Switch to the master branch if needed:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:foo&gt; git checkout master
toony@poony ~/.../horton:master&gt;</pre>
</div>
<p>The master branch is the official branch of Horton. Also make sure there
are no uncommitted changes in the source code before switching to the
master branch.</p>
</li>
<li><p class="first">Get the latest version of the official code:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:master&gt; git pull</pre>
</div>
</li>
<li><p class="first">Make a new branch:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:master&gt; git checkout -b bar
toony@poony ~/.../horton:bar&gt;</pre>
</div>
<p>Only start changing the code and committing patches once you have changed
to a dedicated branch for the implementation of feature <cite>bar</cite>.</p>
</li>
<li><p class="first">Make some changes in the source code. When adding a new feature, also add
tests for that feature. (The more tests, the better.)</p>
</li>
<li><p class="first">Review your changes with <tt class="docutils literal"><span class="pre">git</span> <span class="pre">diff</span></tt>. Make sure there are no trailing spaces
or trailing blank lines. These can be removed with the <tt class="docutils literal"><span class="pre">./cleancode.sh</span></tt>
script. If you created new files, run the <tt class="docutils literal"><span class="pre">./updateheaders.py</span></tt> script to
make sure the new files have the propper headers.</p>
</li>
<li><p class="first">Review the changed/new files with <tt class="docutils literal"><span class="pre">git</span> <span class="pre">status</span></tt></p>
</li>
<li><p class="first">Select the files/changes that will be committed with <tt class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></tt>. There are
two ways to do this:</p>
<ul>
<li><p class="first">Add all changes in certain files:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:bar&gt; git add horton/file1.py horton/file2.py ...</pre>
</div>
</li>
<li><p class="first">Interactively go through the changes in all/some files:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:bar&gt; git add -p [horton/file1.py horton/file2.py ...]</pre>
</div>
</li>
</ul>
</li>
<li><p class="first">Commit the selected files to your working branch:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:bar&gt; git commit -m 'Short description'</pre>
</div>
</li>
</ol>
<p>In practice, you&#8217;ll make a few commits before a new feature is finished. After
adding a few commits, testing them thoroughly and having them reviewed by a
peer, you may want to transfer your commits from your working branch <tt class="docutils literal"><span class="pre">bar</span></tt> to
the master branch. This is done as follows:</p>
<ol class="arabic">
<li><p class="first">Switch to the master branch:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:bar&gt; git checkout master
toony@poony ~/.../horton:master&gt;</pre>
</div>
</li>
<li><p class="first">Get the latest version of the official code:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:master&gt; git pull</pre>
</div>
</li>
<li><p class="first">Switch to your working branch:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:master&gt; git checkout bar
toony@poony ~/.../horton:bar&gt;</pre>
</div>
</li>
<li><p class="first"><cite>Rebase</cite> your commits on top of the latest master branch:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:bar&gt; git rebase master</pre>
</div>
</li>
</ol>
<blockquote>
This command will try to apply the patches from your working branch to the
master branch. It may happen that others have changed the official version
such that your patches do no longer simply apply. When that is the case,
the <tt class="docutils literal"><span class="pre">git</span> <span class="pre">rebase</span></tt> script will interrupt and tell you what to do.</blockquote>
<ol class="arabic" start="5">
<li><p class="first">Run all tests again once the rebase procedure is completed.</p>
</li>
<li><p class="first">Upload the commits:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:bar&gt; git push origin bar:master</pre>
</div>
<p>This may fail when someone has uploaded yet a few more patches in the
meantime. Start again at step 1 to update your patches.</p>
</li>
</ol>
</div>
<div class="section" id="git-shortcuts">
<h3>Git shortcuts<a class="headerlink" href="#git-shortcuts" title="Permalink to this headline">¶</a></h3>
<p>The above procedures are rather lengthly, and for small changes there are
shortcuts that are more convenient.</p>
<ol class="arabic">
<li><p class="first">One may commit all changed files (not new ones) without using <tt class="docutils literal"><span class="pre">git</span> <span class="pre">add</span></tt> first:</p>
<div class="highlight-python"><pre>git commit -a -m 'Short description'</pre>
</div>
</li>
<li><p class="first">One does not have to switch to a working branch to commit a few patches. This
can also be done in the master branch with less commands:</p>
<ol class="loweralpha">
<li><p class="first">Get the latest official patches (in the master branch):</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:master&gt; git pull</pre>
</div>
</li>
<li><p class="first">Make some changes, test and commit:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:master&gt; git commit -a -m 'Short description'</pre>
</div>
</li>
<li><p class="first">Do a combined rebase and pull:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:master&gt; git pull --rebase</pre>
</div>
<p>If someone has added patches to the master branch in the meantime, they
will be downloaded. Your patches are then applied afterwards with <tt class="docutils literal"><span class="pre">git</span>
<span class="pre">rebase</span></tt> automatically.</p>
</li>
<li><p class="first">Upload your commits:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:master&gt; git push</pre>
</div>
</li>
</ol>
<p>The downside of this approach is that one may accidentally make merges if
one does not carefully follow the instructions. Merges make the history
of the master branch non-linear, which is messy and hard to follow.</p>
</li>
</ol>
</div>
</div>
<div class="section" id="writing-tests">
<h2>Writing tests<a class="headerlink" href="#writing-tests" title="Permalink to this headline">¶</a></h2>
<p>Horton uses the <a class="reference external" href="http://somethingaboutorange.com/mrl/projects/nose/0.11.2/">Nosetests</a>
program to run all validation routines. Use one of the existing tests as an
example, or go through the Nosetests documentation to learn how to write tests
from scratch.</p>
<p>All tests in Horton are located in the directory <tt class="docutils literal"><span class="pre">horton/test</span></tt>. All module
files containing tests have a filename that starts with <tt class="docutils literal"><span class="pre">test_</span></tt>. In these
modules, all functions with a name that starts with <tt class="docutils literal"><span class="pre">test_</span></tt> are picked up
by Nosetests. Tests that do not follow this convention, are simply ignored.</p>
<p>The tests are run as follows (including preparation steps):</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:master&gt; ./cleanfiles.sh
toony@poony ~/.../horton:master&gt; ./setup.py build_ext -i
toony@poony ~/.../horton:master&gt; nosetests -v</pre>
</div>
<p>There are some cases where the first two commands are not needed. You will
figure out eventually.</p>
</div>
<div class="section" id="writing-documentation">
<h2>Writing documentation<a class="headerlink" href="#writing-documentation" title="Permalink to this headline">¶</a></h2>
<p>All the documentation is located in the <tt class="docutils literal"><span class="pre">doc</span></tt> directory. We use the <a class="reference external" href="http://sphinx.pocoo.org/">Sphinx</a>
formatting engine to compile the <cite>documentation source code</cite> into fancy
formatted HTML or PDF. Sphinx can be found here: <a class="reference external" href="http://todo">http://todo</a></p>
<p>The source files have the extension <tt class="docutils literal"><span class="pre">.rst</span></tt>, and are written in the
<a class="reference external" href="http://docutils.sourceforge.net/rst.html">ReStructuredText</a> (RST) format.
RST in some sense comparable to latex, but more intuitive to use.
It also has some specific advantages for documenting software.</p>
<p>All <tt class="docutils literal"><span class="pre">.rst</span></tt>-files are part of the source tree, just like the actual source
code. Git is also used to keep track of changes in the documentation.</p>
<p>There is a makefile to generate the documentation based in the source code:</p>
<div class="highlight-python"><pre>toony@poony ~/.../horton:master&gt; cd doc
toony@poony ~/.../horton/doc:master&gt; make html
toony@poony ~/.../horton/doc:master&gt; make pdf</pre>
</div>
</div>
<div class="section" id="add-yourself-as-an-author">
<h2>Add yourself as an author<a class="headerlink" href="#add-yourself-as-an-author" title="Permalink to this headline">¶</a></h2>
<p>The authors of Horton are listed in a few places. This matters for the
open-source license. (In the long run, it would be better to have a small
consortium that can hold the copyrights, but it is too early for that.)</p>
<ul class="simple">
<li>If you are going to write source code, update the source headers and commit a
patch as follows:<ol class="arabic">
<li>Edit HEADER and add your name and email</li>
<li>Run the script <tt class="docutils literal"><span class="pre">./updateheaders.py</span></tt></li>
<li><tt class="docutils literal"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-a</span> <span class="pre">-m</span> <span class="pre">'Hello</span> <span class="pre">horton</span> <span class="pre">source</span> <span class="pre">code!'</span></tt></li>
</ol>
</li>
<li>If you are going to write documentation, update the file <tt class="docutils literal"><span class="pre">doc/conf.py</span></tt> and
commit that change. There is no need to run some update script.</li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Getting Started</a><ul>
<li><a class="reference internal" href="#coding-guidelines">Coding guidelines</a></li>
<li><a class="reference internal" href="#git-the-fast-version-control-system">Git: the fast version control system</a><ul>
<li><a class="reference internal" href="#configuring-git">Configuring Git</a></li>
<li><a class="reference internal" href="#some-terminology">Some terminology</a></li>
<li><a class="reference internal" href="#adding-a-feature">Adding a feature</a></li>
<li><a class="reference internal" href="#git-shortcuts">Git shortcuts</a></li>
</ul>
</li>
<li><a class="reference internal" href="#writing-tests">Writing tests</a></li>
<li><a class="reference internal" href="#writing-documentation">Writing documentation</a></li>
<li><a class="reference internal" href="#add-yourself-as-an-author">Add yourself as an author</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="tut_theory.html"
                        title="previous chapter">Theoretical background</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="dev_milestones.html"
                        title="next chapter">Milestones</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/dev_getting_started.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" size="18" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="dev_milestones.html" title="Milestones"
             >next</a> |</li>
        <li class="right" >
          <a href="tut_theory.html" title="Theoretical background"
             >previous</a> |</li>
        <li><a href="index.html">Horton v0.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Toon Verstraelen.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.0.1.
    </div>
  </body>
</html>